"use strict";(self.webpackChunklamasat=self.webpackChunklamasat||[]).push([[250],{7250:(b,Z,s)=>{s.r(Z),s.d(Z,{CustomerModule:()=>qt});var l=s(8583),a=s(3679),p=s(4655),m=s(7238),_=s(8939),T=s(6058);const C=[(0,m.X$)("in",[(0,m.SB)("in",(0,m.oB)({opacity:1,transform:"translateY(0)"})),(0,m.eR)("void=>*",[(0,m.oB)({opacity:0,transform:"translateY(100px)"}),(0,m.jt)(1e3)])])];var g=s(959),t=s(7716),u=s(9357),x=s(221),F=s(1822),S=s(6926),N=s(1988),f=s(8603),h=s(171),M=s(6627),I=s(743),w=s(4885),q=s(5939),J=s(7767),O=s(9365),y=s(8590);function P(o,n){1&o&&(t.ynx(0),t._UZ(1,"img",56),t.BQk())}function Q(o,n){1&o&&t._uU(0," Save ")}function Y(o,n){1&o&&t._UZ(0,"mat-spinner")}function D(o,n){if(1&o&&(t.TgZ(0,"option",57),t._uU(1),t.qZA()),2&o){const e=n.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",e," ")}}function k(o,n){if(1&o&&(t.TgZ(0,"td"),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.name," ")}}function j(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"td"),t.TgZ(1,"input",60),t.NdJ("change",function(r){return t.CHM(e),t.oxw().$implicit.discount=r.target.value}),t.qZA(),t.qZA()}if(2&o){const e=t.oxw().$implicit,i=t.oxw(3);t.xp6(1),t.Q6J("value",e.discount)("disabled",i.isDisabled)}}function E(o,n){if(1&o&&(t.TgZ(0,"tr"),t.YNc(1,k,2,1,"td",24),t.YNc(2,j,2,2,"td",24),t.qZA()),2&o){const e=n.index,i=t.oxw(3);t.Q6J("@in",i.DataState),t.xp6(1),t.Q6J("ngIf",e<i.categories.length/2),t.xp6(1),t.Q6J("ngIf",e<i.categories.length/2)}}function B(o,n){if(1&o&&(t.TgZ(0,"td"),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.name," ")}}function $(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"td"),t.TgZ(1,"input",60),t.NdJ("change",function(r){return t.CHM(e),t.oxw().$implicit.discount=r.target.value}),t.qZA(),t.qZA()}if(2&o){const e=t.oxw().$implicit,i=t.oxw(3);t.xp6(1),t.Q6J("value",e.discount)("disabled",i.isDisabled)}}function G(o,n){if(1&o&&(t.TgZ(0,"tr"),t.YNc(1,B,2,1,"td",24),t.YNc(2,$,2,2,"td",24),t.qZA()),2&o){const e=n.index,i=t.oxw(3);t.Q6J("@in",i.DataState),t.xp6(1),t.Q6J("ngIf",e>=i.categories.length/2),t.xp6(1),t.Q6J("ngIf",e>=i.categories.length/2)}}function R(o,n){if(1&o&&(t.TgZ(0,"div",19),t.TgZ(1,"div",18),t.TgZ(2,"div",32),t.TgZ(3,"table",58),t.TgZ(4,"thead"),t.TgZ(5,"th"),t._uU(6,"Categories"),t.qZA(),t.TgZ(7,"th"),t._uU(8,"Discount"),t.qZA(),t.qZA(),t.TgZ(9,"tbody"),t.YNc(10,E,3,3,"tr",59),t.qZA(),t.qZA(),t.qZA(),t.TgZ(11,"div",32),t.TgZ(12,"table",58),t.TgZ(13,"thead"),t.TgZ(14,"th"),t._uU(15,"Categories"),t.qZA(),t.TgZ(16,"th"),t._uU(17,"Discount"),t.qZA(),t.qZA(),t.TgZ(18,"tbody"),t.YNc(19,G,3,3,"tr",59),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&o){const e=t.oxw(2);t.xp6(10),t.Q6J("ngForOf",e.categories),t.xp6(9),t.Q6J("ngForOf",e.categories)}}function H(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"section",7),t.TgZ(1,"div",8),t.TgZ(2,"button",9),t.NdJ("click",function(){return t.CHM(e),t.oxw().Submit()}),t._UZ(3,"img",10),t.YNc(4,P,2,0,"ng-container",11),t.YNc(5,Q,1,0,"ng-template",null,12,t.W1O),t.qZA(),t._uU(7,"` "),t.qZA(),t.TgZ(8,"mat-accordion",13),t.TgZ(9,"mat-expansion-panel",14),t.TgZ(10,"mat-expansion-panel-header"),t.TgZ(11,"mat-panel-title",15),t._uU(12," Customer Info "),t.qZA(),t.TgZ(13,"mat-panel-description",16),t.TgZ(14,"mat-icon"),t._uU(15,"Info"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(16,"form",17),t.NdJ("ngSubmit",function(){return t.CHM(e),t.oxw().Submit()}),t.TgZ(17,"div",18),t.TgZ(18,"div",19),t.TgZ(19,"label",20),t.NdJ("click",function(){return t.CHM(e),t.oxw().fetchNewCustomerName()}),t._uU(20,"Customer ID "),t.TgZ(21,"span",21),t._uU(22,"*"),t.qZA(),t.qZA(),t.TgZ(23,"div",22),t._UZ(24,"input",23),t.YNc(25,Y,1,0,"mat-spinner",24),t.qZA(),t._UZ(26,"validation-control",25),t.qZA(),t.TgZ(27,"div",19),t.TgZ(28,"label",26),t._uU(29,"Type "),t.TgZ(30,"span",21),t._uU(31,"*"),t.qZA(),t.qZA(),t.TgZ(32,"div",27),t.TgZ(33,"div",28),t.TgZ(34,"select",29),t.NdJ("click",function(r){return t.CHM(e),t.oxw().displayCategories(r.target.value)}),t.YNc(35,D,2,2,"option",30),t.qZA(),t._UZ(36,"validation-control",31),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(37,"div",18),t.TgZ(38,"div",32),t.TgZ(39,"label",33),t._uU(40,"Name "),t.TgZ(41,"span",21),t._uU(42,"*"),t.qZA(),t.qZA(),t._UZ(43,"input",34),t._UZ(44,"validation-control",35),t.qZA(),t.TgZ(45,"div",32),t.TgZ(46,"label",36),t._uU(47,"Note"),t.qZA(),t._UZ(48,"input",37),t.qZA(),t.qZA(),t.TgZ(49,"div",18),t.TgZ(50,"div",32),t.TgZ(51,"label",38),t._uU(52,"Email"),t.qZA(),t._UZ(53,"input",39),t._UZ(54,"validation-control",40),t.qZA(),t.TgZ(55,"div",32),t.TgZ(56,"label",41),t._uU(57,"Shipment "),t.TgZ(58,"span",21),t._uU(59,"*"),t.qZA(),t.qZA(),t._UZ(60,"br"),t.TgZ(61,"div",18),t.TgZ(62,"div",42),t.TgZ(63,"div",43),t._UZ(64,"input",44),t.TgZ(65,"label",45),t._uU(66,"Yes"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(67,"div",19),t.TgZ(68,"div",43),t._UZ(69,"input",46),t.TgZ(70,"label",45),t._uU(71,"No"),t.qZA(),t.qZA(),t.qZA(),t._UZ(72,"validation-control",47),t.qZA(),t.qZA(),t.qZA(),t.TgZ(73,"div",18),t.TgZ(74,"div",32),t.TgZ(75,"div",48),t.TgZ(76,"label"),t._uU(77,"Phone "),t.TgZ(78,"span",21),t._uU(79,"*"),t.qZA(),t.qZA(),t._UZ(80,"input",49),t._UZ(81,"validation-control",50),t.qZA(),t.TgZ(82,"div",51),t.TgZ(83,"label"),t._uU(84,"Phone 2 "),t.qZA(),t._UZ(85,"input",52),t.qZA(),t.TgZ(86,"div",51),t.TgZ(87,"label",53),t._uU(88,"Address"),t.qZA(),t._UZ(89,"input",54),t.qZA(),t.qZA(),t.YNc(90,R,20,2,"div",55),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=t.MAs(6),i=t.oxw();t.xp6(4),t.Q6J("ngIf",i.loading)("ngIfElse",e),t.xp6(4),t.Q6J("multi",!0),t.xp6(1),t.Q6J("expanded",!0),t.xp6(7),t.Q6J("formGroup",i.customerForm),t.xp6(9),t.Q6J("ngIf",i.loadingRequestNew),t.xp6(10),t.Q6J("ngForOf",i.type),t.xp6(55),t.Q6J("ngIf",i.activeCategories)}}function z(o,n){1&o&&t._UZ(0,"mat-spinner")}function V(o,n){if(1&o&&(t.TgZ(0,"option",57),t._uU(1),t.qZA()),2&o){const e=n.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",e," ")}}function L(o,n){if(1&o&&(t.TgZ(0,"td"),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.name," ")}}function X(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"td"),t.TgZ(1,"input",60),t.NdJ("change",function(r){return t.CHM(e),t.oxw().$implicit.discount=r.target.value}),t.qZA(),t.qZA()}if(2&o){const e=t.oxw().$implicit,i=t.oxw(3);t.xp6(1),t.Q6J("value",e.discount)("disabled",i.isDisabled)}}function K(o,n){if(1&o&&(t.TgZ(0,"tr"),t.YNc(1,L,2,1,"td",24),t.YNc(2,X,2,2,"td",24),t.qZA()),2&o){const e=n.index,i=t.oxw(3);t.Q6J("@in",i.DataState),t.xp6(1),t.Q6J("ngIf",e<i.categories.length/2),t.xp6(1),t.Q6J("ngIf",e<i.categories.length/2)}}function W(o,n){if(1&o&&(t.TgZ(0,"td"),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.name," ")}}function tt(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"td"),t.TgZ(1,"input",60),t.NdJ("change",function(r){return t.CHM(e),t.oxw().$implicit.discount=r.target.value}),t.qZA(),t.qZA()}if(2&o){const e=t.oxw().$implicit,i=t.oxw(3);t.xp6(1),t.Q6J("value",e.discount)("disabled",i.isDisabled)}}function et(o,n){if(1&o&&(t.TgZ(0,"tr"),t.YNc(1,W,2,1,"td",24),t.YNc(2,tt,2,2,"td",24),t.qZA()),2&o){const e=n.index,i=t.oxw(3);t.Q6J("@in",i.DataState),t.xp6(1),t.Q6J("ngIf",e>=i.categories.length/2),t.xp6(1),t.Q6J("ngIf",e>=i.categories.length/2)}}function ot(o,n){if(1&o&&(t.TgZ(0,"div",19),t.TgZ(1,"div",18),t.TgZ(2,"div",32),t.TgZ(3,"table",58),t.TgZ(4,"thead"),t.TgZ(5,"th"),t._uU(6,"Categories"),t.qZA(),t.TgZ(7,"th"),t._uU(8,"Discount"),t.qZA(),t.qZA(),t.TgZ(9,"tbody"),t.YNc(10,K,3,3,"tr",59),t.qZA(),t.qZA(),t.qZA(),t.TgZ(11,"div",32),t.TgZ(12,"table",58),t.TgZ(13,"thead"),t.TgZ(14,"th"),t._uU(15,"Categories"),t.qZA(),t.TgZ(16,"th"),t._uU(17,"Discount"),t.qZA(),t.qZA(),t.TgZ(18,"tbody"),t.YNc(19,et,3,3,"tr",59),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&o){const e=t.oxw(2);t.xp6(10),t.Q6J("ngForOf",e.categories),t.xp6(9),t.Q6J("ngForOf",e.categories)}}function it(o,n){if(1&o&&(t.TgZ(0,"div",75),t.TgZ(1,"div",76),t.TgZ(2,"div",77),t.TgZ(3,"label",78),t._uU(4,"Date:"),t.qZA(),t.TgZ(5,"p"),t._uU(6),t.qZA(),t.qZA(),t.TgZ(7,"div",79),t.TgZ(8,"label",78),t._uU(9,"Amount:"),t.qZA(),t.TgZ(10,"p"),t._uU(11),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&o){const e=n.$implicit;t.xp6(6),t.Oqu(e.created_at),t.xp6(5),t.Oqu(e.amount)}}const nt=function(o){return[o]};function rt(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"section",61),t.TgZ(1,"mat-tab-group",62),t.TgZ(2,"mat-tab",63),t.TgZ(3,"div",64),t.TgZ(4,"form",17),t.NdJ("ngSubmit",function(){return t.CHM(e),t.oxw().Submit()}),t.TgZ(5,"div",18),t.TgZ(6,"div",19),t.TgZ(7,"label",20),t.NdJ("click",function(){return t.CHM(e),t.oxw().fetchNewCustomerName()}),t._uU(8,"Customer ID "),t.TgZ(9,"span",21),t._uU(10,"*"),t.qZA(),t.qZA(),t.TgZ(11,"div",22),t._UZ(12,"input",23),t.YNc(13,z,1,0,"mat-spinner",24),t.qZA(),t._UZ(14,"validation-control",25),t.qZA(),t.TgZ(15,"div",19),t.TgZ(16,"label",26),t._uU(17,"Type "),t.TgZ(18,"span",21),t._uU(19,"*"),t.qZA(),t.qZA(),t.TgZ(20,"div",27),t.TgZ(21,"div",28),t.TgZ(22,"select",29),t.NdJ("click",function(r){return t.CHM(e),t.oxw().displayCategories(r.target.value)}),t.YNc(23,V,2,2,"option",30),t.qZA(),t._UZ(24,"validation-control",31),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(25,"div",18),t.TgZ(26,"div",32),t.TgZ(27,"label",33),t._uU(28,"Name "),t.TgZ(29,"span",21),t._uU(30,"*"),t.qZA(),t.qZA(),t._UZ(31,"input",34),t._UZ(32,"validation-control",35),t.qZA(),t.TgZ(33,"div",32),t.TgZ(34,"label",36),t._uU(35,"Note"),t.qZA(),t._UZ(36,"input",37),t.qZA(),t.qZA(),t.TgZ(37,"div",18),t.TgZ(38,"div",32),t.TgZ(39,"label",38),t._uU(40,"Email"),t.qZA(),t._UZ(41,"input",39),t._UZ(42,"validation-control",40),t.qZA(),t.TgZ(43,"div",32),t.TgZ(44,"label",41),t._uU(45,"Shipment "),t.TgZ(46,"span",21),t._uU(47,"*"),t.qZA(),t.qZA(),t._UZ(48,"br"),t.TgZ(49,"div",18),t.TgZ(50,"div",42),t.TgZ(51,"div",43),t._UZ(52,"input",44),t.TgZ(53,"label",45),t._uU(54,"Yes"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(55,"div",19),t.TgZ(56,"div",43),t._UZ(57,"input",46),t.TgZ(58,"label",45),t._uU(59,"No"),t.qZA(),t.qZA(),t.qZA(),t._UZ(60,"validation-control",47),t.qZA(),t.qZA(),t.qZA(),t.TgZ(61,"div",18),t.TgZ(62,"div",32),t.TgZ(63,"div",48),t.TgZ(64,"label"),t._uU(65,"Phone "),t.TgZ(66,"span",21),t._uU(67,"*"),t.qZA(),t.qZA(),t._UZ(68,"input",49),t._UZ(69,"validation-control",50),t.qZA(),t.TgZ(70,"div",51),t.TgZ(71,"label"),t._uU(72,"Phone 2 "),t.qZA(),t._UZ(73,"input",52),t.qZA(),t.TgZ(74,"div",18),t.TgZ(75,"div",32),t.TgZ(76,"label",53),t._uU(77,"Address"),t.qZA(),t._UZ(78,"input",54),t.qZA(),t.TgZ(79,"div",32),t.TgZ(80,"label",65),t._uU(81,"Balance"),t.qZA(),t._UZ(82,"input",66),t.qZA(),t.qZA(),t.qZA(),t.YNc(83,ot,20,2,"div",55),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(84,"mat-tab",67),t._UZ(85,"shared-archive-order"),t.qZA(),t.TgZ(86,"mat-tab",68),t._UZ(87,"shared-archive-invoice"),t.qZA(),t.TgZ(88,"mat-tab",69),t.TgZ(89,"div",70),t.TgZ(90,"button",71),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(),c=t.MAs(6);return r.Show(c)}),t._UZ(91,"img",72),t.qZA(),t.qZA(),t.TgZ(92,"div",73),t.YNc(93,it,12,2,"div",74),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=t.oxw();t.xp6(4),t.Q6J("formGroup",e.customerForm),t.xp6(9),t.Q6J("ngIf",e.loadingRequestNew),t.xp6(10),t.Q6J("ngForOf",e.type),t.xp6(59),t.Q6J("value",t.VKq(6,nt,null==e.customer?null:e.customer.customer_balance)),t.xp6(1),t.Q6J("ngIf",e.activeCategories),t.xp6(10),t.Q6J("ngForOf",null==e.customer?null:e.customer.payment_customer_in)}}function st(o,n){1&o&&t._UZ(0,"img",56)}function at(o,n){if(1&o&&(t.ynx(0),t.YNc(1,st,1,0,"img",86),t.BQk()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",e.loading)}}function ct(o,n){1&o&&(t._UZ(0,"img",10),t._uU(1," Save "))}const mt=function(o,n){return{"is-invalid":o,"is-valid":n}},lt=function(o){return{validation:"required",message:"payment is required",control:o}},ut=function(o){return{validation:"min",message:"payment must be at least 1",control:o}};function dt(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"form",17),t.NdJ("ngSubmit",function(){t.CHM(e);const r=t.oxw();return r.submitPayment(r.paymentGroup.value)}),t.TgZ(1,"div",80),t.TgZ(2,"div",48),t.TgZ(3,"label"),t._uU(4,"Payment"),t.qZA(),t._UZ(5,"input",81),t.GkF(6,82),t.GkF(7,82),t.qZA(),t.qZA(),t._UZ(8,"br"),t.TgZ(9,"div",18),t.TgZ(10,"div",19),t.TgZ(11,"button",83),t.NdJ("click",function(){return t.CHM(e),t.oxw().closeModal()}),t._uU(12," X Cancel "),t.qZA(),t.qZA(),t.TgZ(13,"div",19),t.TgZ(14,"button",84),t.YNc(15,at,2,1,"ng-container",11),t.YNc(16,ct,2,0,"ng-template",null,85,t.W1O),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=t.MAs(17),i=t.oxw(),r=t.MAs(12);t.Q6J("formGroup",i.paymentGroup),t.xp6(5),t.Q6J("ngClass",t.WLB(8,mt,i.paymentGroup.controls.amount.invalid,i.paymentGroup.controls.amount.valid)),t.xp6(1),t.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",t.VKq(11,lt,i.paymentGroup.controls.amount)),t.xp6(1),t.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",t.VKq(13,ut,i.paymentGroup.controls.amount)),t.xp6(8),t.Q6J("ngIf",i.loading)("ngIfElse",e)}}function gt(o,n){if(1&o&&(t.ynx(0),t.TgZ(1,"div",87),t.TgZ(2,"span",88),t._uU(3),t.qZA(),t.qZA(),t.BQk()),2&o){const e=t.oxw().message;t.xp6(3),t.hij(" ",e," ")}}function pt(o,n){if(1&o&&t.YNc(0,gt,4,1,"ng-container",24),2&o){const e=n.control;t.Q6J("ngIf",e.hasError(n.validation)&&(e.dirty||e.touched))}}let A=(()=>{class o{constructor(e,i,r,c,d,yt,Ut,Ft,St){this._formBuilder=e,this._customerService=i,this._activatedRoute=r,this._categoryService=c,this._validationService=d,this._helperService=yt,this._userService=Ut,this._modalService=Ft,this._router=St,this.loading=!1,this.formSubmit=!1,this.type=["partner","big","small","direct","distribution"],this.categories=[],this.activeCategories=!1,this.DataState="void",this.part="Add",this.types=[{name:"partner"},{name:"big"},{name:"small"},{name:"direct"},{name:"distribution"}],this.loadingItems=!1,this.loadingRequestNew=!1}ngOnInit(){this.fetchData(),this.subscribeRoute()}initialControls(){this.initialValueForm()}fetchData(){this.fetchCategoryCustomerDiscount(),this.fetchCategories(),this.fetchNewCustomerName()}fetchNewCustomerName(){this.loadingRequestNew=!0,this._userService.getNewNamesModel(T.i.customer).pipe((0,_.x)(()=>this.loadingRequestNew=!1)).subscribe(e=>this.customerForm.patchValue({serial:e.data}))}fetchCategories(){this._categoryService.getAllCategories().subscribe(e=>this.allCategories=e.data)}fetchCategoryCustomerDiscount(){this._categoryService.getAllCategories().subscribe(e=>{this.categories=[],this.DataState="in",e.data.forEach(i=>{this.categories.push({category_id:i.id,name:i.name,discount:0})})})}subscribeRoute(){this._activatedRoute.params.subscribe(e=>{this.customerId=+e.customerId,this.isUpdated=null!=e.customerId,this.initialForm(),this.isUpdated&&(this.customerId=+this.customerId,this.initialValueForm(),this.initialPaymentForm(),this.initialControls()),String(window.location.href).includes("form")&&!this.isUpdated?this.part="Add":String(window.location.href).includes("form")?(this.isDisabled=!1,this.customerForm.enable(),this.part="Edit"):(this.isDisabled=!0,this.customerForm.disable(),this.part="Info")})}initialValueForm(){this._customerService.getDetailsCustomer(this.customerId).subscribe(e=>{var i=e.data;this.customer=i,this.customer.payment_customer_in=this.customer.payment_customer_in.map(this._helperService.ReadDateClearly),this.categories=[],i.category.forEach(r=>{this.categories.push({category_id:r.category_id,name:r.name,discount:r.discount})}),"direct"!=i.type&&(this.DataState="in",this.activeCategories=!0),this.customerForm.patchValue({serial:i.serial,type:i.type,name:i.name,email:i.email,phone:i.phone,phone2:i.phone2,address:i.address,is_charge:i.is_charge?"yes":"no",note:i.note,categories:this.categories})})}initialForm(){this.customerForm=this._formBuilder.group({serial:[null,a.kI.required],type:[null,a.kI.required],name:[null,a.kI.required],note:[null,a.kI.nullValidator],email:[null,[a.kI.required,a.kI.email]],is_charge:[null,a.kI.required],phone:[null,a.kI.required],phone2:[null,a.kI.nullValidator],address:[null,a.kI.nullValidator],categories:[this.categories]}),this._validationService.formSubject.next({form:this.customerForm,submit:this.formSubmit}),this.formSubscribe=this.customerForm.valueChanges.subscribe(()=>{this._validationService.formSubject.next({form:this.customerForm,submit:this.formSubmit})})}initialPaymentForm(){this.paymentGroup=this._formBuilder.group({amount:[0,[a.kI.required,a.kI.min(1)]],customer_id:[this.customerId,[a.kI.required]]})}Submit(){this.isDisabled?(this.customerForm.enable(),this.isDisabled=!1,this.part="Edit"):(this.customerForm.patchValue({is_charge:"yes"==this.customerForm.get("is_charge").value}),"direct"!=this.customerForm.get("type").value&&this.customerForm.patchValue({categories:this.categories}),this.formSubmit=!0,this.loading=!0,this.customerForm.valid?this.isUpdated?this._customerService.updateCustomerInformation(this.customerId,this.customerForm.value).pipe((0,_.x)(()=>{this.loading=!1})).subscribe(e=>{this._router.navigate(["customer/all"])}):this._customerService.addCustomer(this.customerForm.value).pipe((0,_.x)(()=>{this.loading=!1})).subscribe(e=>{this._router.navigate(["customer/all"])}):(this._validationService.validateAllFormFields(this.customerForm),this._validationService.formSubject.next({form:this.customerForm,submit:this.formSubmit}),this.loading=!1))}submitPayment(e){this.loading=!0,this._customerService.createPaymentCustomer(e).pipe((0,_.x)(()=>this.loading=!1)).subscribe(i=>{var r,c=i.data;c.created_at=this._helperService.formatDate(String(c.created_at).split("T")[0],!1),this.customer.customer_balance+=(null===(r=this.customer)||void 0===r?void 0:r.customer_balance)+c.amount,this.closeModal(),this.customer.payment_customer_in.push(c)})}Show(e,i=!1){this.modalRef=this._modalService.open(e,{size:i?"lg":"md",modalClass:"mymodal",hideCloseButton:!1,centered:!1,backdrop:!0,animation:!0,keyboard:!1,closeOnOutsideClick:!0,backdropClass:"modal-backdrop"})}closeModal(){this._modalService.close(this.modalRef)}displayCategories(e){"direct"==e||""==e?(this.activeCategories=!1,this.DataState="void"):(this.activeCategories=!0,this.DataState="in")}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(a.qu),t.Y36(u.v),t.Y36(p.gz),t.Y36(x.H),t.Y36(F.R),t.Y36(S.s),t.Y36(N.K),t.Y36(f.gk),t.Y36(p.F0))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-customer-form"]],decls:13,vars:4,consts:[[1,"nav-title-header","fs-4","fw-bold","text-center"],[1,"container"],["style","margin-left: 12rem; margin-top: 6rem",4,"ngIf"],["style","margin-left: 12rem;","class","mt-4",4,"ngIf"],["paymentModal",""],[3,"formGroup","ngSubmit",4,"ngIf"],["formError",""],[2,"margin-left","12rem","margin-top","6rem"],[1,"d-flex","d-flex-reverse"],[1,"btn","btn-success",3,"click"],["src","assets/action-data/save.svg","width","20"],[4,"ngIf","ngIfElse"],["saveTemplate",""],[1,"example-headers-align","mt-3","mb-4","col-md-4","mt-3",2,"position","relative",3,"multi"],[1,"mt-3",3,"expanded"],[1,"text-uppercase"],[1,"d-flex","justify-content-end","d-flex"],[3,"formGroup","ngSubmit"],[1,"row"],[1,"col-md-6"],["for","customerId",1,"cursor-pointer",3,"click"],[1,"text-danger"],[1,"position-relative"],["type","text","id","customerId","formControlName","serial","disabled","",1,"form-control"],[4,"ngIf"],["field","serial"],["for","type"],[1,"test",2,"position","inherit"],[1,"select-arrow"],["id","type","formControlName","type",1,"form-control",3,"click"],[3,"value",4,"ngFor","ngForOf"],["field","type"],[1,"col-md-6","mt-3"],["for","name"],["type","text","id","name","formControlName","name",1,"form-control"],["field","name"],["for","note"],["type","text","formControlName","note",1,"form-control"],["for","email"],["type","email","id","email","formControlName","email",1,"form-control"],["field","email"],["for","shipment",1,"mb-2"],[1,"col-md-4"],[1,"form-check"],["type","radio","name","is_charge","formControlName","is_charge","value","yes",1,"form-check-input"],[1,"form-check-label"],["type","radio","name","is_charge","formControlName","is_charge","value","no",1,"form-check-input"],["field","is_charge"],[1,"col-md-12"],["type","tel","formControlName","phone",1,"form-control"],["field","phone"],[1,"col-md-12","mt-3"],["type","tel","formControlName","phone2",1,"form-control"],["for","address"],["type","text","id","address","formControlName","address",1,"form-control"],["class","col-md-6",4,"ngIf"],["width","30","src","assets/Spinner-1s-257px.svg","alt",""],[3,"value"],[1,"table",2,"text-align","center"],[4,"ngFor","ngForOf"],["type","number","min","0","max","100",1,"form-control",3,"value","disabled","change"],[1,"mt-4",2,"margin-left","12rem"],["mat-align-tabs","center","animationDuration","1.5s"],["label","Customer Detail",1,"p-5"],[1,"card","p-4"],["for","customer_balance"],["disabled","","type","number","id","customer_balance",1,"form-control",3,"value"],["label","Archive Orders",1,"p-4"],["label","Archive Invoices",1,"p-4"],["label","Balance",1,"p-4"],[1,"btn-action"],[1,"btn","btn-primary","btn-inside",3,"click"],["mat-raised-button","","matTooltip","Add New Payment","matTooltipPosition","above","src","assets/action-data/plus-circle-dotted.svg","alt","plus add","width","45"],[1,"row","p-2"],["class","col-md-3 mt-3",4,"ngFor","ngForOf"],[1,"col-md-3","mt-3"],[1,"card","p-3",2,"border-radius","20px"],[1,"d-flex","justify-content-around"],[1,"fw-bold"],[1,"d-flex","justify-content-around","mt-3"],[1,"row","align-items-lg-center","justify-content-around"],["placeholder","Enter your payment","type","number","min","1","formControlName","amount",1,"form-control",3,"ngClass"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["type","button",1,"btn","btn-danger","w-100",3,"click"],["type","submit",1,"btn","btn-success","w-100"],["elseTemplate",""],["width","30","src","assets/Spinner-1s-257px.svg","alt","",4,"ngIf"],[1,"fv-plugins-message-container"],["role","alert",1,"text-danger"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t._uU(1),t.qZA(),t.TgZ(2,"div",1),t.YNc(3,H,91,8,"section",2),t.YNc(4,rt,94,8,"section",3),t.qZA(),t.TgZ(5,"modal",null,4),t.TgZ(7,"modal-header"),t._uU(8," Payment Modal "),t.qZA(),t.TgZ(9,"modal-content"),t.YNc(10,dt,18,15,"form",5),t.qZA(),t.qZA(),t.YNc(11,pt,1,1,"ng-template",null,6,t.W1O)),2&e&&(t.xp6(1),t.hij(" Customer > ",i.part,"\n"),t.xp6(2),t.Q6J("ngIf","Info"!=i.part),t.xp6(1),t.Q6J("ngIf","Info"==i.part),t.xp6(6),t.Q6J("ngIf","Info"==i.part))},directives:[l.O5,f.zS,f.Rb,f.Ef,h.pp,h.ib,h.yz,h.yK,h.u4,M.Hw,a._Y,a.JL,a.sg,a.Fj,a.JJ,a.u,I.n,a.EJ,l.sg,a._,w.$g,a.YN,a.Kr,q.SP,q.uX,J.c,O.w,y.gM,a.qQ,a.wV,l.mk,l.tP],styles:[".card[_ngcontent-%COMP%]{box-shadow:-1px 2px 6px}.vl[_ngcontent-%COMP%]{border-left:2px solid;height:35px}tbody[_ngcontent-%COMP%], td[_ngcontent-%COMP%], tfoot[_ngcontent-%COMP%], thead[_ngcontent-%COMP%], tr[_ngcontent-%COMP%]{border-style:none}.example-headers-align[_ngcontent-%COMP%]   .mat-expansion-panel-header-title[_ngcontent-%COMP%], .example-headers-align[_ngcontent-%COMP%]   .mat-expansion-panel-header-description[_ngcontent-%COMP%]{flex-basis:0}.example-headers-align[_ngcontent-%COMP%]   .mat-expansion-panel-header-description[_ngcontent-%COMP%]{justify-content:space-between;align-items:center}.example-headers-align[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%] + .mat-form-field[_ngcontent-%COMP%]{margin-left:8px}[_nghost-%COMP%]     .mat-paginator-container{justify-content:space-between}[_nghost-%COMP%]     .mat-paginator{background:transparent}  .mat-form-field-appearance-outline .mat-form-field-outline{background-color:#fff;border-radius:10px}.example-additional-selection[_ngcontent-%COMP%]{opacity:.75;font-size:.75em}.mat-sort-header-container[_ngcontent-%COMP%]{justify-content:center!important}[_nghost-%COMP%]     mat-spinner{width:25px!important;height:25px!important;position:absolute!important;top:7px!important;right:43px!important}[_nghost-%COMP%]     mat-spinner svg{width:25px!important;height:25px!important}[_nghost-%COMP%]     mat-tab-header.mat-tab-header{border-radius:20px!important}[_nghost-%COMP%]     .mat-tab-body-content{overflow:hidden!important}[_nghost-%COMP%]     .mat-tab-body-wrapper{padding:1rem!important}.btn-action[_ngcontent-%COMP%]{position:fixed;bottom:0;right:0;padding:50px;z-index:1000}.btn-action[_ngcontent-%COMP%]   .btn-inside[_ngcontent-%COMP%]{height:75px;width:75px;border-radius:50%!important}"],data:{animation:[(0,m.X$)("in",[(0,m.SB)("in",(0,m.oB)({opacity:1,transform:"translateX(0)"})),(0,m.eR)("void=>*",[(0,m.oB)({opacity:0,transform:"translateX(50px)"}),(0,m.jt)(1e3)])]),g.M,C]}}),o})();var _t=s(8259),v=s.n(_t),Zt=s(8818),U=s(1494),ft=s(5058);function ht(o,n){if(1&o&&(t.TgZ(0,"div",9),t.TgZ(1,"p",10),t._uU(2),t.qZA(),t.qZA()),2&o){const e=n.$implicit;t.xp6(1),t.Q6J("mat-sort-header",e),t.xp6(1),t.Oqu(e)}}function vt(o,n){1&o&&t._UZ(0,"ngx-skeleton-loader",11)}function Tt(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"div",12),t.TgZ(1,"div",13),t.TgZ(2,"div",14),t._uU(3),t.qZA(),t.TgZ(4,"div",14),t._uU(5),t.qZA(),t.TgZ(6,"div",14),t._uU(7),t.qZA(),t.TgZ(8,"div",14),t._uU(9),t.qZA(),t.TgZ(10,"div",14),t._uU(11),t.qZA(),t.TgZ(12,"div",15),t.TgZ(13,"img",16),t.NdJ("click",function(){const c=t.CHM(e).$implicit;return t.oxw().GetCustomerInfo(c.id)}),t.qZA(),t._UZ(14,"div",17),t.TgZ(15,"img",18),t.NdJ("click",function(){const c=t.CHM(e).$implicit;return t.oxw().routeToEdit(c.id)}),t.qZA(),t._UZ(16,"div",17),t.TgZ(17,"img",19),t.NdJ("click",function(){const c=t.CHM(e).$implicit;return t.oxw().DeleteCustomer(c.id)}),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=n.$implicit;t.xp6(3),t.Oqu(e.serial),t.xp6(2),t.Oqu(e.name),t.xp6(2),t.Oqu(e.type),t.xp6(2),t.Oqu(e.phone),t.xp6(2),t.Oqu(e.phone2)}}const Ct=[{path:"all",component:(()=>{class o{constructor(e,i){this._customerService=e,this._router=i,this.loadingItems=!1,this.DataState="void",this.headers=["Customer_ID","Name","Type","Phone","Phone_2","Settings"]}ngOnInit(){this.fetchData()}fetchData(){this.getCustomers()}getCustomers(){this.loadingItems=!0,this._customerService.getAllCustomers().pipe((0,_.x)(()=>{this.loadingItems=!1})).subscribe(e=>{this.datasource=e.data.data,this.DataState="in",this.sortedData=this.datasource.slice()})}DeleteCustomer(e){v().fire({title:"Are you sure?",text:"You will not be able to recover this imaginary file!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"No, keep it"}).then(i=>{i.isConfirmed?this._customerService.removeCustomer(e).subscribe(r=>{v().fire("Deleted!","Your imaginary file has been deleted.","success"),this.getCustomers()}):i.dismiss===v().DismissReason.cancel&&v().fire("Cancelled","Your imaginary file is safe :)","error")})}routeToAdd(){this._router.navigate(["customer/form"])}routeToEdit(e){this._router.navigate(["customer/form",e])}GetCustomerInfo(e){this._router.navigate(["customer/find",e])}sortData(e){const i=this.datasource.slice();this.sortedData=e.active&&""!==e.direction?i.sort((r,c)=>{const d="asc"===e.direction;switch(e.active){case"Name":return this.compare(r.Name,c.Name,d);case"Customer_ID":return this.compare(r.Customer_ID,c.Customer_ID,d);case"Type":return this.compare(r.Type,c.Type,d);case"Phone":return this.compare(r.Phone,c.Phone,d);case"Phone_2":return this.compare(r.Phone_2,c.Phone_2,d);case"Settings":return this.compare(r.Settings,c.Settings,d);default:return 0}}):i}compare(e,i,r){return(e<i?-1:1)*(r?1:-1)}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(u.v),t.Y36(p.F0))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-customer-main"]],decls:12,vars:4,consts:[[1,"nav-title-header","fs-4","fw-bold","text-center"],[1,"container"],[1,"d-flex","flex-row-reverse"],[1,"btn","btn-success","mb-3","btn-add",3,"click"],["matSort","",3,"matSortChange"],[1,"row"],["class","col-md-2 ","style","text-align: center;font-weight: bold;font-size: 17px;",4,"ngFor","ngForOf"],["count","10",4,"ngIf"],["class","card mt-3 p-2","style","border-radius: 20px;",4,"ngFor","ngForOf"],[1,"col-md-2",2,"text-align","center","font-weight","bold","font-size","17px"],[3,"mat-sort-header"],["count","10"],[1,"card","mt-3","p-2",2,"border-radius","20px"],[1,"row",2,"text-align","center","align-items","center"],[1,"col-md-2"],[1,"col-md-2",2,"display","flex","justify-content","space-evenly"],["mat-raised-button","","matTooltip","info","matTooltipPosition","above","src","assets/action-data/Group 317.svg","width","23",2,"cursor","pointer",3,"click"],[1,"vl"],["mat-raised-button","","matTooltip","edit","matTooltipPosition","above","src","assets/action-data/edit.svg","width","23",2,"cursor","pointer",3,"click"],["mat-raised-button","","matTooltip","delete","matTooltipPosition","above","src","assets/action-data/delete.svg","width","20",2,"cursor","pointer",3,"click"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t._uU(1,"Customer"),t.qZA(),t.TgZ(2,"div",1),t.TgZ(3,"section"),t.TgZ(4,"div",2),t.TgZ(5,"button",3),t.NdJ("click",function(){return i.routeToAdd()}),t._uU(6,"+ Add New Customer"),t.qZA(),t.qZA(),t.TgZ(7,"div",4),t.NdJ("matSortChange",function(c){return i.sortData(c)}),t.TgZ(8,"div",5),t.YNc(9,ht,3,2,"div",6),t.qZA(),t.YNc(10,vt,1,0,"ngx-skeleton-loader",7),t.YNc(11,Tt,18,5,"div",8),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(7),t.Q6J("@in",i.DataState),t.xp6(2),t.Q6J("ngForOf",i.headers),t.xp6(1),t.Q6J("ngIf",i.loadingItems),t.xp6(1),t.Q6J("ngForOf",i.sortedData))},directives:[U.YE,l.sg,l.O5,U.nU,ft.xr,y.gM],styles:[".card[_ngcontent-%COMP%]{box-shadow:-1px 2px 6px}.vl[_ngcontent-%COMP%]{border-left:2px solid;height:35px}.mat-sort-header-container[_ngcontent-%COMP%]{justify-content:center!important}"],data:{animation:[Zt.b]}}),o})()},{path:"form",component:A},{path:"form/:customerId",component:A},{path:"find/:customerId",component:A}];let xt=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[p.Bz.forChild(Ct)],p.Bz]}),o})();var At=s(6018),bt=s(71);let qt=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[l.ez,a.u5,a.UX,xt,f.zk,At.SharedModule,bt.E],p.Bz]}),o})()},6058:(b,Z,s)=>{s.d(Z,{i:()=>l});var l=(()=>{return(a=l||(l={})).Order="order",a.RequestOrder="request_order",a.Group="group",a.customer="customer",l;var a})()},1988:(b,Z,s)=>{s.d(Z,{K:()=>C});var l=s(9765),a=s(3927);class p extends a.s{constructor(t){super(t,"api")}AuthLogin(t){return this.createEntity(t,"/login")}GetNewNameModel(t){return this.readEntity(void 0,"/get/name/"+t)}}var m=s(7716),_=s(1841),T=s(1188);let C=(()=>{class g{constructor(u,x){this._storageService=x,this.localStorageUser=new l.xQ,this.authActions=new p(u)}loginUser(u){return this.authActions.AuthLogin(u)}setLocalStorageUser(u){this._storageService.setLocalObject("user",u),this.localStorageUser.next(u)}getUser(){return this.localStorageUser.asObservable()}logout(){this._storageService.removeToken(),this._storageService.removeLocalObject("user"),this.localStorageUser.next(null)}getNewNamesModel(u){return this.authActions.GetNewNameModel(u)}}return g.\u0275fac=function(u){return new(u||g)(m.LFG(_.eN),m.LFG(T.V))},g.\u0275prov=m.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),g})()}}]);