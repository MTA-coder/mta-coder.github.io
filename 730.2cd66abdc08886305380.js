"use strict";(self.webpackChunklamasat=self.webpackChunklamasat||[]).push([[730],{3730:(R,Z,r)=>{r.r(Z),r.d(Z,{RequestModule:()=>yt});var _=r(8583),f=r(4655),l=r(3679),v=r(8939),c=r(8259),u=r.n(c),m=r(6058),e=r(7716),p=r(3927);class h extends p.s{constructor(o){super(o,"order/request")}findRequest(o){return this.readEntity(o,"/find")}filterRequest(o){return this.readEntities(void 0,"/get/"+o)}changeRequest(o){return this.createEntity(o,"/change")}payRequest(o){return this.createEntity(o,"/payment")}payDesignRequest(o){return this.createEntity(o,"/design/payment")}}var C=r(1841);let k=(()=>{class i{constructor(t){this.requestActions=new h(t)}filterStateRequest(t){return this.requestActions.filterRequest(t)}infoRequest(t){return this.requestActions.findRequest(t)}moveAllOrdersNewRequest(t){return this.requestActions.changeRequest(t)}payOrderRequest(t){return this.requestActions.payRequest(t)}createInDesignPayment(t){return this.requestActions.payDesignRequest(t)}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(C.eN))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var se=r(3922),E=r(6926),D=r(8603),Y=r(1822),le=r(9724),ce=r(1988),U=r(171),J=r(5939),ue=r(8590),Q=r(9992),O=r(8295),de=r(9983),j=r(6627),me=r(743),pe=r(7539),M=r(7832),he=r(1095),ge=r(5396),H=r(4885);let _e=(()=>{class i{transform(t,n){return 0!==(null==t?void 0:t.length)&&""!==n&&void 0!==n?t.filter(a=>a.name.toLowerCase().includes(n.toLowerCase())||a.number.toLowerCase().includes(n.toLowerCase())||a.product.name.toLowerCase().includes(n.toLowerCase())||a.product.category.name.toLowerCase().includes(n.toLowerCase())):t}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275pipe=e.Yjl({name:"orderSearch",type:i,pure:!0}),i})();const fe=["orderLists"],ve=["orderInvoiceLists"];function Ze(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"div",126),e.TgZ(1,"div",127),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw().nav(s.id)}),e.TgZ(2,"h2",32),e._uU(3),e.qZA(),e.TgZ(4,"div",95),e.TgZ(5,"div",128),e.TgZ(6,"span",129),e._uU(7,"Product"),e.qZA(),e._UZ(8,"br"),e.TgZ(9,"span",130),e._uU(10),e.qZA(),e.qZA(),e.TgZ(11,"div",128),e.TgZ(12,"span",129),e._uU(13,"Category"),e.qZA(),e._UZ(14,"br"),e.TgZ(15,"span",130),e._uU(16),e.qZA(),e.qZA(),e.TgZ(17,"div",128),e.TgZ(18,"span",129),e._uU(19,"Final Price"),e.qZA(),e._UZ(20,"br"),e.TgZ(21,"span",130),e._uU(22),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=o.$implicit;e.xp6(3),e.Oqu(t.name),e.xp6(7),e.Oqu(t.product.name),e.xp6(6),e.Oqu(t.product.category.name),e.xp6(6),e.Oqu(t.finale_amount)}}function qe(i,o){if(1&i&&(e.TgZ(0,"mat-accordion",131),e.TgZ(1,"mat-expansion-panel",3),e.TgZ(2,"mat-expansion-panel-header"),e.TgZ(3,"mat-panel-title",132),e.TgZ(4,"h3"),e._uU(5),e.qZA(),e.qZA(),e.qZA(),e.TgZ(6,"div",30),e.TgZ(7,"label",32),e._uU(8,"Amount:"),e.qZA(),e.TgZ(9,"p"),e._uU(10),e.qZA(),e.qZA(),e.TgZ(11,"div",34),e.TgZ(12,"label",32),e._uU(13,"Type:"),e.qZA(),e.TgZ(14,"p"),e._uU(15),e.qZA(),e.qZA(),e.TgZ(16,"div",34),e.TgZ(17,"label",32),e._uU(18,"Design:"),e.qZA(),e.TgZ(19,"p"),e._uU(20),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&i){const t=o.$implicit;e.xp6(5),e.Oqu(t.created_at),e.xp6(5),e.Oqu(t.amount.toFixed(2)),e.xp6(5),e.Oqu(t.is_in?"Deposited":"Withdrawal"),e.xp6(5),e.Oqu(t.customer?"NO":"YES")}}const be=function(i,o,t){return{"text-uppercase":!0,"text-danger":i,"text-success":o,"text-warning":t}};function Te(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"div",133),e.NdJ("click",function(){const s=e.CHM(t).$implicit,d=e.oxw(),I=e.MAs(85);return d.fetchInfoInvoice(I,s.id)}),e.TgZ(1,"div",134),e.TgZ(2,"h3",135),e.TgZ(3,"div"),e._uU(4),e.qZA(),e.TgZ(5,"div"),e._uU(6,"State: "),e.TgZ(7,"span",136),e._uU(8),e.qZA(),e.qZA(),e.qZA(),e.TgZ(9,"h4",137),e.TgZ(10,"div"),e._uU(11),e.qZA(),e.TgZ(12,"div"),e._uU(13),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=o.$implicit;e.xp6(4),e.Oqu("Num: "+t.number),e.xp6(3),e.Q6J("ngClass",e.kEZ(5,be,"canceled"==t.state,"paid"==t.state,"not_paid"==t.state)),e.xp6(1),e.hij(" ",t.state," "),e.xp6(3),e.Oqu("Price: "+t.total_amount),e.xp6(2),e.Oqu("Date :"+t.created_at)}}const Ae=function(i){return{"row-odd":i}};function Ce(i,o){if(1&i&&(e.TgZ(0,"mat-list-option",136),e.TgZ(1,"div",4),e.TgZ(2,"div",8),e._uU(3),e.qZA(),e.TgZ(4,"div",8),e._uU(5),e.qZA(),e.TgZ(6,"div",8),e._uU(7),e.qZA(),e.qZA(),e.qZA()),2&i){const t=o.$implicit;e.Q6J("ngClass",e.VKq(4,Ae,o.index%2==0)),e.xp6(3),e.Oqu(t.name),e.xp6(2),e.Oqu(t.product.name),e.xp6(2),e.Oqu(t.product.category.name)}}function we(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"button",138),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(),s=e.MAs(134);return a.Show2(s,!1)}),e._uU(1,"Paid"),e.qZA()}}function Ie(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"button",139),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return a.deleteInvoice(null==a.InfoInvoiceDetail?null:a.InfoInvoiceDetail.id)}),e._uU(1,"Cancelled"),e.qZA()}}const V=function(i){return["fw-bold",i]};function xe(i,o){if(1&i&&(e.TgZ(0,"div",8),e.TgZ(1,"label"),e._uU(2),e.qZA(),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Tol(e.VKq(3,V,t.balanceAccount?"text-danger":"")),e.xp6(1),e.hij(" Balance is ",null==t.InfoInvoiceDetail?null:t.InfoInvoiceDetail.customer_Balance.toFixed(2),"")}}function De(i,o){if(1&i&&(e.TgZ(0,"mat-hint"),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.hij(" total payments is ",null==t.InfoInvoiceDetail?null:t.InfoInvoiceDetail.total_amount.toFixed(2),"")}}function ye(i,o){1&i&&e._UZ(0,"img",140)}function Me(i,o){if(1&i&&(e.TgZ(0,"div",44),e._uU(1),e.TgZ(2,"span",45),e._uU(3),e.qZA(),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.hij(" Total Invoice :",t.requestInvoice.total_price_order.toFixed(2)," "),e.xp6(2),e.hij("After Discount : ",t.InvoicePrice.toFixed(2),"")}}function Se(i,o){1&i&&e._uU(0,"Choose Orders")}function Re(i,o){if(1&i&&(e.TgZ(0,"mat-list-option",141),e._uU(1),e.qZA()),2&i){const t=o.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.name," ")}}function ke(i,o){1&i&&(e.ynx(0),e._UZ(1,"img",140),e.BQk())}function Ue(i,o){1&i&&e._uU(0," Next ")}function Oe(i,o){1&i&&e._uU(0,"Choose Payment")}function Pe(i,o){if(1&i&&(e.TgZ(0,"div",100),e.TgZ(1,"label"),e._uU(2),e.qZA(),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Tol(e.VKq(3,V,t.balanceAccount?"text-danger":"")),e.xp6(1),e.hij(" Balance is ",t.requestInvoice.customer_Balance.toFixed(2),"")}}function Fe(i,o){if(1&i&&(e.TgZ(0,"mat-hint"),e._uU(1),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.hij(" total payments is ",t.requestInvoice.total_payments.toFixed(2),"")}}function Ne(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"div",47),e.TgZ(1,"div",48),e.TgZ(2,"mat-form-field",49),e.TgZ(3,"mat-label"),e._uU(4,"Discount"),e.qZA(),e.TgZ(5,"input",50),e.NdJ("input",function(a){return e.CHM(t),e.oxw().reduceTotalInvoice(a.target.value)}),e.qZA(),e.TgZ(6,"mat-icon",51),e._uU(7,"discount"),e.qZA(),e.qZA(),e._UZ(8,"validation-control",52),e.qZA(),e.TgZ(9,"div",48),e.TgZ(10,"div",53),e.YNc(11,Pe,3,5,"div",142),e.TgZ(12,"div",100),e.TgZ(13,"mat-checkbox",56),e.NdJ("change",function(){return e.CHM(t),e.oxw().disableControls()}),e._uU(14,"Customer Balance"),e.qZA(),e._UZ(15,"validation-control",57),e.qZA(),e.qZA(),e.qZA(),e.TgZ(16,"div",48),e.TgZ(17,"mat-form-field",49),e.TgZ(18,"mat-label"),e._uU(19,"Payment"),e.qZA(),e.TgZ(20,"mat-icon",51),e._uU(21,"money"),e.qZA(),e._UZ(22,"input",58),e.YNc(23,Fe,2,1,"mat-hint",59),e.qZA(),e._UZ(24,"validation-control",60),e.TgZ(25,"p",61),e._uU(26),e.qZA(),e.qZA(),e.TgZ(27,"div",48),e.TgZ(28,"mat-form-field",49),e.TgZ(29,"mat-label"),e._uU(30,"Cash"),e.qZA(),e._UZ(31,"input",62),e.TgZ(32,"mat-icon",51),e._uU(33,"attach_money"),e.qZA(),e.qZA(),e._UZ(34,"validation-control",63),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.xp6(11),e.Q6J("ngIf",null!=t.requestInvoice&&t.invoiceGroup.controls.customer_balance.value),e.xp6(12),e.Q6J("ngIf",null!=t.requestInvoice&&!t.invoiceGroup.controls.customer_balance.value),e.xp6(3),e.Oqu(t.messageError)}}function Ge(i,o){1&i&&e._UZ(0,"img",140)}function Be(i,o){if(1&i&&(e.ynx(0),e.YNc(1,Ge,1,0,"img",70),e.BQk()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.loading)}}function Ee(i,o){1&i&&(e._UZ(0,"img",143),e._uU(1," Save "))}function Ye(i,o){if(1&i&&(e.TgZ(0,"option",144),e._uU(1),e.qZA()),2&i){const t=o.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.name,"")}}function Je(i,o){1&i&&e._UZ(0,"mat-spinner")}function Qe(i,o){if(1&i&&(e.TgZ(0,"mat-list-option",141),e._uU(1),e.qZA()),2&i){const t=o.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.name," ")}}function je(i,o){1&i&&e._UZ(0,"img",140)}function He(i,o){if(1&i&&(e.ynx(0),e.YNc(1,je,1,0,"img",70),e.BQk()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.loading)}}function Ve(i,o){1&i&&(e._UZ(0,"img",143),e._uU(1," Save "))}function Le(i,o){if(1&i&&(e.ynx(0),e.TgZ(1,"div",145),e.TgZ(2,"span",146),e._uU(3),e.qZA(),e.qZA(),e.BQk()),2&i){const t=e.oxw().message;e.xp6(3),e.hij(" ",t," ")}}function ze(i,o){if(1&i&&e.YNc(0,Le,4,1,"ng-container",59),2&i){const t=o.control;e.Q6J("ngIf",t.hasError(o.validation)&&(t.dirty||t.touched))}}const We=function(i,o){return{"is-invalid":i,"is-valid":o}},$e=function(i){return{validation:"required",message:"payment is required",control:i}},Ke=function(i){return{validation:"min",message:"payment must be at least 1",control:i}};let Xe=(()=>{class i{constructor(t,n,a,s,d,I,S,g,x,N,Mt,St){this._requestService=t,this._invoiceService=n,this._activatedRoute=a,this._helper=s,this._modalService=d,this._formBuilder=I,this._helperService=S,this._validationService=g,this._validation2Service=x,this._swalService=N,this._router=Mt,this._userService=St,this.loading=!1,this.formPaidSubmit=!1,this.loadingEdit=!1,this.loadingRequests=!1,this.requests=[],this.isNewRequest=!1,this.isPaid=!0,this.messageError="",this.messageError2="",this.InvoicePrice=0,this.InvoicePaidPrice=0,this.balanceAccount=!1,this.loadingRequestNew=!1}ngOnInit(){this.subscribeRoute()}initialForm(){this.changeRequestGroup=this._formBuilder.group({order_ids:[[],l.kI.required],source_request_order_id:[this.requestId,l.kI.required],destination_request_order_new:[!1,l.kI.required],destination_request_order_id:[null,l.kI.nullValidator],destination_request_order_name:[null,l.kI.nullValidator]})}initialFormPayment(){this.paymentGroup=this._formBuilder.group({amount:[0,[l.kI.required,l.kI.min(1)]],is_design:[!1,[l.kI.required]],request_order_id:[this.requestId,[l.kI.required]]})}initialOrderInvoiceForm(){this.orderInvoiceGroup=this._formBuilder.group({request_order_id:[this.requestId,l.kI.required],order_ids:[[],l.kI.required]})}initialInvoiceForm(){this.invoiceGroup=this._formBuilder.group({number:[null,l.kI.required],request_order_id:[this.requestId,l.kI.required],order_ids:[[],l.kI.required],is_paid:[!0,l.kI.required],not_paid:[!0,l.kI.required],customer_balance:[!1,l.kI.required],cash:[0,[l.kI.min(0)]],payment_out:[0,[l.kI.min(0)]],discount:[0,[l.kI.min(0)]],note:[null,l.kI.nullValidator]}),this._validationService.formSubject.next({form:this.invoiceGroup,submit:this.formSubmit}),this.formSubscripted=this.invoiceGroup.valueChanges.subscribe(()=>{this._validationService.formSubject.next({form:this.invoiceGroup,submit:this.formSubmit})})}initialInvoicePaid(){this.invoicePaidGroup=this._formBuilder.group({invoice_id:[0,l.kI.required],discount:[0,[l.kI.min(0),l.kI.nullValidator]],customer_balance:[!1,l.kI.nullValidator],cash:[0,[l.kI.min(0),l.kI.nullValidator]],payment_out:[0,[l.kI.min(0),l.kI.nullValidator]],note:[null,l.kI.nullValidator]}),this._validation2Service.formSubject.next({form:this.invoicePaidGroup,submit:this.formPaidSubmit}),this.formSubscripted=this.invoiceGroup.valueChanges.subscribe(()=>{this._validation2Service.formSubject.next({form:this.invoicePaidGroup,submit:this.formPaidSubmit})})}subscribeRoute(){this._activatedRoute.params.subscribe(t=>{this.requestId=+t.requestId,this.fetchData(),this.initialForms()})}initialForms(){this.initialForm(),this.initialFormPayment(),this.initialOrderInvoiceForm(),this.initialInvoiceForm(),this.initialInvoicePaid()}fetchData(){this.fetchRequestInfo(),this.fetchRequests()}fetchRequestInfo(){this._requestService.infoRequest(this.requestId).subscribe(t=>{var n=t.data;this.request=n,this.request.orders.forEach(a=>a.created_at=this._helper.formatDate(String(a.created_at).split("T")[0],!1)),this.request.invoices.forEach(a=>a.created_at=this._helper.formatDate(String(a.created_at).split("T")[0],!1)),this.request.payments.map(this._helperService.ReadDateTimeClearly).slice(),this.requestNewInvoice=n})}fetchRequests(){this.loadingRequests=!0,this._requestService.filterStateRequest("open").pipe((0,v.x)(()=>this.loadingRequests=!1)).subscribe(t=>{this.requests=t.data.data.filter(a=>a.id!=this.requestId)})}fetchInfoInvoice(t,n){this.invoicePaidGroup.patchValue({invoice_id:n}),this.Show(t),this._invoiceService.findInvoiceById(n).subscribe(a=>{this.InfoInvoiceDetail=a.data,this.InfoInvoiceDetail.payments.map(this._helperService.ReadDateClearly).slice(),this.InvoicePaidPrice=this.InfoInvoiceDetail.total_amount})}ChangeRequest(){this.loading=!0;var t=[];this.orderLists.selectedOptions.selected.forEach(n=>t.push(n.value)),this.changeRequestGroup.patchValue({order_ids:t}),this._requestService.moveAllOrdersNewRequest(this.changeRequestGroup.value).pipe((0,v.x)(()=>this.loading=!1)).subscribe(n=>{this.orderLists.deselectAll(),this.closeModal()})}submitPayment(t){this.paymentGroup.valid&&(this.loading=!0,this.paymentGroup.controls.is_design.value?this._requestService.createInDesignPayment(t).pipe((0,v.x)(()=>this.loading=!1)).subscribe(n=>{"ERROR"==n.status?this._swalService.error("Operation Failed","some of orders selected are existing in invoices please check out"):(this.request.payments.push([n.data].map(this._helperService.ReadDateTimeClearly)[0]),this.paymentGroup.controls.amount.setValue(0),this.paymentGroup.controls.is_design.setValue(!1),this.closeModal())}):this._requestService.payOrderRequest(t).pipe((0,v.x)(()=>this.loading=!1)).subscribe(n=>{"ERROR"==n.status?this._swalService.error("Operation Failed","some of orders selected are existing in invoices please check out"):(this.request.payments.push([n.data].map(this._helperService.ReadDateTimeClearly)[0]),this.paymentGroup.controls.amount.setValue(0),this.paymentGroup.controls.is_design.setValue(!1),this.closeModal())}))}checkoutInvoice(t){this.loading=!0,this.orderInvoiceIds=[],this.orderInvoiceLists.selectedOptions.selected.forEach(n=>this.orderInvoiceIds.push(n.value)),0!=this.orderInvoiceIds.length?(this.orderInvoiceGroup.patchValue({order_ids:this.orderInvoiceIds}),this._invoiceService.calculateInvoicePrice(this.orderInvoiceGroup.value).pipe((0,v.x)(()=>this.loading=!1)).subscribe(n=>{"ERROR"==n.status?this._swalService.error("Operation Failed","this request hadn't have design salary"):(this.requestInvoice=n.data,this.InvoicePrice=this.requestInvoice.total_price_order,this.messageError="",this.invoiceGroup.patchValue({order_ids:this.orderInvoiceIds}),t.next())})):(this.loading=!1,this.messageError="please select at least one order")}submitInvoice(){if(this.formSubmit=!0,this.invoiceGroup.valid){this.invoiceGroup.patchValue({not_paid:!this.invoiceGroup.controls.is_paid.value});var t=this.invoiceGroup.value;this.messageError=t.payment_out+t.cash!=this.InvoicePrice?"your payment and cash is not equal for invoice price":"",""==this.messageError&&this._invoiceService.createInvoice(t).subscribe(n=>{var a=n.data;a.created_at=this._helperService.formatDate(String(a.created_at).split("T")[0],!1),this.request.invoices.push(a),this.invoiceGroup.reset(),this.invoiceGroup.patchValue({request_order_id:this.requestId,is_paid:!0,not_paid:!0,cash:0,payment_out:0,discount:0}),this.closeModal()})}else this._validationService.validateAllFormFields(this.invoiceGroup),this._validationService.formSubject.next({form:this.invoiceGroup,submit:this.formSubmit}),this.formSubmit=!1}deleteInvoice(t){this._swalService.showWarning().then(n=>{n.isConfirmed?this._invoiceService.cancelInvoiceById(t).subscribe(a=>{var s=this.request.invoices.findIndex(d=>d.id==t);this.request.invoices[s].state="canceled",this.closeModal(),this._swalService.success()}):n.dismiss===u().DismissReason.cancel&&this._swalService.cancelOperation()})}submitInvoicePaid(){if(this.formPaidSubmit=!0,this.invoicePaidGroup.valid){this.loading=!0;var t=this.invoicePaidGroup.value;this.messageError2=t.payment_out+t.cash!=this.InvoicePaidPrice?"your payment and cash is not equal for invoice price":"",""==this.messageError2&&this._invoiceService.updateInvoicePaid(t).subscribe(n=>{this._invoiceService.findInvoiceById(this.InfoInvoiceDetail.id).pipe((0,v.x)(()=>this.loading=!1)).subscribe(a=>{this.InfoInvoiceDetail=a.data,this.InfoInvoiceDetail.payments.map(this._helperService.ReadDateClearly).slice();var s=this.request.invoices.findIndex(d=>d.id==this.InfoInvoiceDetail.id);this.request.invoices[s].state="paid",this.invoicePaidGroup.reset(),this.invoicePaidGroup.patchValue({discount:0,customer_balance:!1,cash:0,payment_out:0}),this.closeModal2()})})}else this._validation2Service.validateAllFormFields(this.invoicePaidGroup),this._validation2Service.formSubject.next({form:this.invoicePaidGroup,submit:this.formPaidSubmit}),this.formPaidSubmit=!1}Show(t,n=!1){this.modalRef=this._modalService.open(t,{size:n?"lg":"md",modalClass:"mymodal",hideCloseButton:!1,centered:!1,backdrop:!0,animation:!0,keyboard:!1,closeOnOutsideClick:!0,backdropClass:"modal-backdrop"})}Show2(t,n=!1){this.modalRef2=this._modalService.open(t,{size:n?"lg":"md",modalClass:"mymodal",hideCloseButton:!1,centered:!1,backdrop:!0,animation:!0,keyboard:!1,closeOnOutsideClick:!0,backdropClass:"modal-backdrop"})}closeModal(){this._modalService.close(this.modalRef)}closeModal2(){this._modalService.close(this.modalRef2)}nav(t){this._router.navigate(["order/find",t])}navDestination(){this._router.navigate(["/request/find",this.changeRequestGroup.controls.destination_request_order_id.value])}disableControls(){this.invoiceGroup.controls.customer_balance.value?(this.balanceAccount=this.requestInvoice.customer_Balance!=this.InvoicePrice,this.invoiceGroup.controls.payment_out.disable(),this.invoiceGroup.controls.cash.disable()):(this.invoiceGroup.controls.payment_out.enable(),this.invoiceGroup.controls.cash.enable())}reduceTotalInvoice(t){var n=this.invoiceGroup.controls.discount;n.setValidators([l.kI.min(0),l.kI.max(this.requestInvoice.total_price_order)]),n.valid&&(this.InvoicePrice=this.requestInvoice.total_price_order-t,this.balanceAccount=this.invoiceGroup.controls.customer_balance.value&&this.InvoicePrice!=this.requestInvoice.customer_Balance)}reduceTotalInvoicePaid(t){var n=this.invoicePaidGroup.controls.discount;n.setValidators([l.kI.min(0),l.kI.max(this.InfoInvoiceDetail.total_amount)]),n.valid&&(this.InvoicePaidPrice=this.InfoInvoiceDetail.total_amount-t,this.balanceAccount=this.invoicePaidGroup.controls.customer_balance.value&&this.InvoicePaidPrice!=this.InfoInvoiceDetail.customer_balance)}disablePaidControls(){this.invoicePaidGroup.controls.customer_balance.value?(this.balanceAccount=this.InfoInvoiceDetail.customer_balance!=this.InvoicePrice,this.invoicePaidGroup.controls.payment_out.disable(),this.invoicePaidGroup.controls.cash.disable()):(this.invoicePaidGroup.controls.payment_out.enable(),this.invoicePaidGroup.controls.cash.enable())}get filterByOrdersState(){var t;return null===(t=this.requestNewInvoice)||void 0===t?void 0:t.orders.filter(n=>"stored"==n.state)}NewRequestName(t){this.changeRequestGroup.get("destination_request_order_id").disabled?this.changeRequestGroup.get("destination_request_order_id").enable():this.changeRequestGroup.get("destination_request_order_id").disable(),t&&(this.loadingRequestNew=!0,this._userService.getNewNamesModel(m.i.RequestOrder).pipe((0,v.x)(()=>this.loadingRequestNew=!1)).subscribe(n=>this.changeRequestGroup.patchValue({destination_request_order_name:n.data})))}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(k),e.Y36(se.q),e.Y36(f.gz),e.Y36(E.s),e.Y36(D.gk),e.Y36(l.qu),e.Y36(E.s),e.Y36(Y.R),e.Y36(Y.R),e.Y36(le.J),e.Y36(f.F0),e.Y36(ce.K))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-request-detail"]],viewQuery:function(t,n){if(1&t&&(e.Gf(fe,5),e.Gf(ve,5)),2&t){let a;e.iGM(a=e.CRH())&&(n.orderLists=a.first),e.iGM(a=e.CRH())&&(n.orderInvoiceLists=a.first)}},decls:332,vars:65,consts:[[1,"nav-title-header","fs-4","fw-bold","text-center"],[1,"container"],[2,"margin-left","12rem","margin-top","6rem"],[2,"border-radius","20px"],[1,"row"],[1,"col-md-4","text-center","d-flex","align-items-center","mb-3","justify-content-between"],[1,"fw-bolder","me-2"],["type","text","disabled","",1,"form-control","w-75","text-center",3,"value"],[1,"col-md-4"],[1,"p-2","border-statistics"],[1,"fw-bolder"],[1,"d-flex","justify-content-around","mt-1"],[1,"fw-bold","ms-auto"],[1,"me-auto","ms-auto"],[1,"mt-4",2,"margin-left","12rem"],["mat-align-tabs","center","animationDuration","1.5s"],["label","Orders",1,"p-4"],[1,"btn-action"],[1,"btn","btn-primary","btn-inside",3,"click"],["mat-raised-button","","matTooltip","Move Orders","matTooltipPosition","above","src","assets/action-data/arrow right.png","alt","move request","width","45"],[1,"row","p-2"],["class","col-md-4 mt-3 position-relative",4,"ngFor","ngForOf"],["label","Payments",1,"p-4"],["mat-raised-button","","matTooltip","Add New Payment","matTooltipPosition","above","src","assets/action-data/plus-circle-dotted.svg","alt","plus add","width","45"],["class","mt-3 col-md-4",4,"ngFor","ngForOf"],["label","Invoices",1,"p-4"],[1,"btn-action",3,"click"],["mat-raised-button","","matTooltip","Add New Invoice","matTooltipPosition","above","src","assets/action-data/plus-circle-dotted.svg","alt","plus add","width","45"],["class","col-md-4 mt-3 mb-3 cursor-pointer",3,"click",4,"ngFor","ngForOf"],["invoiceDetailModal",""],[1,"d-flex","justify-content-around"],[1,"p-2","d-flex","justify-content-center"],[1,"fw-bold"],[1,"ms-1"],[1,"d-flex","justify-content-around","mt-2"],[1,"d-flex","justify-content-center","mt-2"],[1,"mt-2"],[1,"mt-1","fw-bolder","mt-2"],[1,"mb-3","mt-2","border",3,"multiple"],[3,"ngClass",4,"ngFor","ngForOf"],["class","btn btn-primary ms-2",3,"click",4,"ngIf"],["class","btn btn-danger ms-2",3,"click",4,"ngIf"],[1,"btn","btn-secondary","ms-2",3,"click"],["invoicePaidModal",""],[1,"d-block","fw-bold"],[1,"text-black-50"],[3,"formGroup"],[1,"row","align-items-baseline"],[1,"col-md-6","mt-2"],["appearance","outline",1,"w-100"],["matInput","","type","number","min","0","formControlName","discount",3,"input"],["matSuffix",""],["field","discount"],[1,"row","text-center"],["class","col-md-4",4,"ngIf"],[1,"col-md-8"],["color","primary","formControlName","customer_balance",1,"w-100",3,"change"],["field","customer_balance"],["matInput","","type","number","min","1","formControlName","payment_out"],[4,"ngIf"],["field","payment_out"],[1,"text-danger"],["matInput","","type","number","min","1","formControlName","cash"],["field","cash"],[1,"row","mt-2"],[1,"col-md-12"],["matInput","","rows","3","formControlName","note"],["field","note"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-primary","ms-1",3,"click"],["width","30","src","assets/Spinner-1s-257px.svg","alt","",4,"ngIf"],["invoiceModal",""],["class","d-block fw-bold",4,"ngIf"],["stepper",""],["errorMessage","please select at least one order"],["matStepLabel",""],[3,"formGroup","ngSubmit"],[1,"row","d-flex","align-items-baseline"],["appearance","outline"],["matInput","","placeholder","Search...",1,"w-100",3,"input"],["type","button","mat-button","","color","primary",1,"w-100",3,"click"],["type","button","mat-button","","color","warn",1,"w-100",3,"click"],[1,"mb-3","mt-2","border"],["orderInvoiceLists",""],["checkboxPosition","before","color","primary",3,"value",4,"ngFor","ngForOf"],[1,"d-flex","flex-row-reverse"],["type","submit","mat-button","",1,"btn-primary"],[4,"ngIf","ngIfElse"],["elseTemplateOrderInvoice",""],["appearance","outline",1,"w-100","pb-0"],["matInput","","required","","type","text","formControlName","number"],["field","number"],["color","primary","formControlName","is_paid",1,"w-100","pb-0"],["field","is_paid"],["class","row align-items-baseline",4,"ngIf"],[1,"d-flex","justify-content-between"],["type","button","mat-button","","matStepperPrevious","",1,"btn-danger"],["type","submit","mat-button","","matStepperNext","",1,"btn-primary"],["paymentModal",""],[1,"row","align-items-lg-center","justify-content-around"],[1,"col-md-6"],["placeholder","Enter your payment","type","number","min","1","formControlName","amount",1,"form-control",3,"ngClass"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["color","primary","formControlName","is_design",1,"w-100","pb-0"],["type","button",1,"btn","btn-danger","w-100",3,"click"],["type","submit",1,"btn","btn-success","w-100"],["elseTemplate",""],["moveModal",""],[1,"row","d-flex"],[1,"col-md-7","mt-4"],[1,"select-arrow"],["formControlName","destination_request_order_id",1,"form-control"],[3,"value",4,"ngFor","ngForOf"],["selected","","hidden","","value","0"],[1,"col-md-5"],[1,"form-check","form-switch"],["type","checkbox","id","flexSwitchCheckDefault","formControlName","destination_request_order_new",1,"form-check-input",3,"change"],["for","flexSwitchCheckDefault",1,"form-check-label"],["type","text","disabled","","formControlName","destination_request_order_name",1,"form-control"],[1,"col-md-6","mt-3"],[1,"col-md-3","mt-3"],["mat-button","","color","primary",1,"w-100",3,"click"],["mat-button","","color","warn",1,"w-100",3,"click"],["orderLists",""],["type","submit",1,"btn","btn-success","w-100",3,"disabled"],["formError",""],[1,"col-md-4","mt-3","position-relative"],[1,"card","p-3","cursor-pointer","postion-relative",3,"click"],[1,"p-1"],[1,"fw-bold","text-black"],[1,"text=primary"],[1,"mt-3","col-md-4"],[1,"d-flex","justify-content-center","pt-3"],[1,"col-md-4","mt-3","mb-3","cursor-pointer",3,"click"],[1,"card","p-4"],[1,"fw-bolder","d-flex","mb-0","justify-content-around"],[3,"ngClass"],[1,"fw-bold","mt-2","d-flex","justify-content-around"],[1,"btn","btn-primary","ms-2",3,"click"],[1,"btn","btn-danger","ms-2",3,"click"],["width","30","src","assets/Spinner-1s-257px.svg","alt",""],["checkboxPosition","before","color","primary",3,"value"],["class","col-md-6",4,"ngIf"],["src","assets/action-data/save.svg","width","20"],[3,"value"],[1,"fv-plugins-message-container"],["role","alert",1,"text-danger"]],template:function(t,n){if(1&t){const a=e.EpF();e.TgZ(0,"div",0),e._uU(1,"Request > MoreDetails"),e.qZA(),e.TgZ(2,"div",1),e.TgZ(3,"section",2),e.TgZ(4,"mat-accordion"),e.TgZ(5,"mat-expansion-panel",3),e.TgZ(6,"mat-expansion-panel-header"),e.TgZ(7,"mat-panel-title"),e._uU(8," Summery "),e.qZA(),e.qZA(),e.TgZ(9,"div",4),e.TgZ(10,"div",5),e.TgZ(11,"label",6),e._uU(12,"Name "),e.qZA(),e._UZ(13,"input",7),e.qZA(),e.TgZ(14,"div",5),e.TgZ(15,"label",6),e._uU(16,"State"),e.qZA(),e._UZ(17,"input",7),e.qZA(),e.TgZ(18,"div",5),e.TgZ(19,"label",6),e._uU(20,"Customer"),e.qZA(),e._UZ(21,"input",7),e.qZA(),e.TgZ(22,"div",8),e.TgZ(23,"div",9),e.TgZ(24,"h4",10),e._uU(25,"Orders"),e.qZA(),e.TgZ(26,"div",11),e.TgZ(27,"label",12),e._uU(28,"Count :"),e.qZA(),e.TgZ(29,"p",13),e._uU(30),e.qZA(),e.qZA(),e.TgZ(31,"div",11),e.TgZ(32,"label",12),e._uU(33,"Price :"),e.qZA(),e.TgZ(34,"p",13),e._uU(35),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(36,"div",8),e.TgZ(37,"div",9),e.TgZ(38,"h4",10),e._uU(39,"Payments"),e.qZA(),e.TgZ(40,"div",11),e.TgZ(41,"label",12),e._uU(42,"Count :"),e.qZA(),e.TgZ(43,"p",13),e._uU(44),e.qZA(),e.qZA(),e.TgZ(45,"div",11),e.TgZ(46,"label",12),e._uU(47,"Price :"),e.qZA(),e.TgZ(48,"p",13),e._uU(49),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(50,"div",8),e.TgZ(51,"div",9),e.TgZ(52,"h4",10),e._uU(53,"Invoices"),e.qZA(),e.TgZ(54,"div",11),e.TgZ(55,"label",12),e._uU(56,"Count :"),e.qZA(),e.TgZ(57,"p",13),e._uU(58),e.qZA(),e.qZA(),e.TgZ(59,"div",11),e.TgZ(60,"label",12),e._uU(61,"Price :"),e.qZA(),e.TgZ(62,"p",13),e._uU(63),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(64,"section",14),e.TgZ(65,"mat-tab-group",15),e.TgZ(66,"mat-tab",16),e.TgZ(67,"div",17),e.TgZ(68,"button",18),e.NdJ("click",function(){e.CHM(a);const d=e.MAs(283);return n.Show(d)}),e._UZ(69,"img",19),e.qZA(),e.qZA(),e.TgZ(70,"div",20),e.YNc(71,Ze,23,4,"div",21),e.qZA(),e.qZA(),e.TgZ(72,"mat-tab",22),e.TgZ(73,"div",17),e.TgZ(74,"button",18),e.NdJ("click",function(){e.CHM(a);const d=e.MAs(257);return n.Show(d)}),e._UZ(75,"img",23),e.qZA(),e.qZA(),e.TgZ(76,"div",20),e.YNc(77,qe,21,4,"mat-accordion",24),e.qZA(),e.qZA(),e.TgZ(78,"mat-tab",25),e.TgZ(79,"div",26),e.NdJ("click",function(){return e.CHM(a),e.MAs(196).reset()}),e.TgZ(80,"button",18),e.NdJ("click",function(){e.CHM(a);const d=e.MAs(191);return n.Show(d,!0)}),e._UZ(81,"img",27),e.qZA(),e.qZA(),e.TgZ(82,"div",4),e.YNc(83,Te,14,9,"div",28),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(84,"modal",null,29),e.TgZ(86,"modal-header"),e.TgZ(87,"h3"),e._uU(88,"Invoice Detail Info"),e.qZA(),e.qZA(),e.TgZ(89,"modal-content"),e.TgZ(90,"div",30),e.TgZ(91,"div",31),e.TgZ(92,"label",32),e._uU(93,"Number"),e.qZA(),e.TgZ(94,"span",33),e._uU(95),e.qZA(),e.qZA(),e.TgZ(96,"div",31),e.TgZ(97,"label",32),e._uU(98,"Discount"),e.qZA(),e.TgZ(99,"span",33),e._uU(100),e.qZA(),e.qZA(),e.qZA(),e.TgZ(101,"div",34),e.TgZ(102,"div",31),e.TgZ(103,"label",32),e._uU(104,"Payment"),e.qZA(),e.TgZ(105,"span",33),e._uU(106),e.qZA(),e.qZA(),e.TgZ(107,"div",31),e.TgZ(108,"label",32),e._uU(109,"Cash Amount:"),e.qZA(),e.TgZ(110,"span",33),e._uU(111),e.qZA(),e.qZA(),e.qZA(),e.TgZ(112,"div",35),e.TgZ(113,"div",31),e.TgZ(114,"label",32),e._uU(115,"Customer Balance"),e.qZA(),e.TgZ(116,"span",33),e._uU(117),e.qZA(),e.qZA(),e.qZA(),e.TgZ(118,"div",36),e.TgZ(119,"label",32),e._uU(120,"Note"),e.qZA(),e._UZ(121,"br"),e.TgZ(122,"span"),e._uU(123),e.qZA(),e.qZA(),e.TgZ(124,"h4",37),e._uU(125,"Orders"),e.qZA(),e.TgZ(126,"mat-selection-list",38),e.YNc(127,Ce,8,6,"mat-list-option",39),e.qZA(),e.qZA(),e.TgZ(128,"modal-footer"),e.YNc(129,we,2,0,"button",40),e.YNc(130,Ie,2,0,"button",41),e.TgZ(131,"button",42),e.NdJ("click",function(){return n.closeModal()}),e._uU(132,"Closed"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(133,"modal",null,43),e.TgZ(135,"modal-header"),e.TgZ(136,"div",44),e._uU(137),e.TgZ(138,"span",45),e._uU(139),e.qZA(),e.qZA(),e.qZA(),e.TgZ(140,"modal-content"),e.TgZ(141,"form",46),e.TgZ(142,"div",47),e.TgZ(143,"div",48),e.TgZ(144,"mat-form-field",49),e.TgZ(145,"mat-label"),e._uU(146,"Discount"),e.qZA(),e.TgZ(147,"input",50),e.NdJ("input",function(d){return n.reduceTotalInvoicePaid(d.target.value)}),e.qZA(),e.TgZ(148,"mat-icon",51),e._uU(149,"discount"),e.qZA(),e.qZA(),e._UZ(150,"validation-control",52),e.qZA(),e.TgZ(151,"div",48),e.TgZ(152,"div",53),e.YNc(153,xe,3,5,"div",54),e.TgZ(154,"div",55),e.TgZ(155,"mat-checkbox",56),e.NdJ("change",function(){return n.disablePaidControls()}),e._uU(156,"Customer Balance"),e.qZA(),e._UZ(157,"validation-control",57),e.qZA(),e.qZA(),e.qZA(),e.TgZ(158,"div",48),e.TgZ(159,"mat-form-field",49),e.TgZ(160,"mat-label"),e._uU(161,"Payment"),e.qZA(),e.TgZ(162,"mat-icon",51),e._uU(163,"money"),e.qZA(),e._UZ(164,"input",58),e.YNc(165,De,2,1,"mat-hint",59),e.qZA(),e._UZ(166,"validation-control",60),e.TgZ(167,"p",61),e._uU(168),e.qZA(),e.qZA(),e.TgZ(169,"div",48),e.TgZ(170,"mat-form-field",49),e.TgZ(171,"mat-label"),e._uU(172,"Cash"),e.qZA(),e._UZ(173,"input",62),e.TgZ(174,"mat-icon",51),e._uU(175,"attach_money"),e.qZA(),e.qZA(),e._UZ(176,"validation-control",63),e.qZA(),e.qZA(),e.TgZ(177,"div",64),e.TgZ(178,"div",65),e.TgZ(179,"mat-form-field",49),e.TgZ(180,"mat-label"),e._uU(181,"Note"),e.qZA(),e._UZ(182,"textarea",66),e.qZA(),e._UZ(183,"validation-control",67),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(184,"modal-footer"),e.TgZ(185,"button",68),e.NdJ("click",function(){return n.closeModal2()}),e._uU(186,"Close"),e.qZA(),e.TgZ(187,"button",69),e.NdJ("click",function(){return n.submitInvoicePaid()}),e.YNc(188,ye,1,0,"img",70),e._uU(189," SaveChanges"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(190,"modal",null,71),e.TgZ(192,"modal-header"),e.YNc(193,Me,4,2,"div",72),e.qZA(),e.TgZ(194,"modal-content"),e.TgZ(195,"mat-stepper",null,73),e.TgZ(197,"mat-step",74),e.YNc(198,Se,1,0,"ng-template",75),e.TgZ(199,"form",76),e.NdJ("ngSubmit",function(){e.CHM(a);const d=e.MAs(196);return n.checkoutInvoice(d)}),e.TgZ(200,"div",77),e.TgZ(201,"div",8),e.TgZ(202,"mat-form-field",78),e.TgZ(203,"mat-label"),e._uU(204,"Search"),e.qZA(),e.TgZ(205,"input",79),e.NdJ("input",function(d){return n.searchOrder=d.target.value}),e.qZA(),e.TgZ(206,"mat-icon",51),e._uU(207,"search"),e.qZA(),e.qZA(),e.TgZ(208,"mat-hint"),e._uU(209,"name number category product "),e.qZA(),e.qZA(),e.TgZ(210,"div",8),e.TgZ(211,"button",80),e.NdJ("click",function(){return e.CHM(a),e.MAs(217).selectAll()}),e._uU(212," Select All "),e.qZA(),e.qZA(),e.TgZ(213,"div",8),e.TgZ(214,"button",81),e.NdJ("click",function(){return e.CHM(a),e.MAs(217).deselectAll()}),e._uU(215," Deselect All "),e.qZA(),e.qZA(),e.qZA(),e.TgZ(216,"mat-selection-list",82,83),e.YNc(218,Re,2,2,"mat-list-option",84),e.ALo(219,"orderSearch"),e.qZA(),e.TgZ(220,"div",61),e._uU(221),e.qZA(),e.TgZ(222,"div",85),e.TgZ(223,"button",86),e.YNc(224,ke,2,0,"ng-container",87),e.YNc(225,Ue,1,0,"ng-template",null,88,e.W1O),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(227,"mat-step"),e.TgZ(228,"form",76),e.NdJ("ngSubmit",function(){return n.submitInvoice()}),e.YNc(229,Oe,1,0,"ng-template",75),e.TgZ(230,"div",47),e.TgZ(231,"div",55),e.TgZ(232,"mat-form-field",89),e.TgZ(233,"mat-label"),e._uU(234,"Number"),e.qZA(),e._UZ(235,"input",90),e.TgZ(236,"mat-icon",51),e._uU(237,"payment"),e.qZA(),e.qZA(),e._UZ(238,"validation-control",91),e.qZA(),e.TgZ(239,"div",8),e.TgZ(240,"mat-slide-toggle",92),e._uU(241," Paid "),e.qZA(),e.qZA(),e._UZ(242,"validation-control",93),e.qZA(),e.YNc(243,Ne,35,3,"div",94),e.TgZ(244,"div",64),e.TgZ(245,"div",65),e.TgZ(246,"mat-form-field",49),e.TgZ(247,"mat-label"),e._uU(248,"Note"),e.qZA(),e._UZ(249,"textarea",66),e.qZA(),e._UZ(250,"validation-control",67),e.qZA(),e.qZA(),e.TgZ(251,"div",95),e.TgZ(252,"button",96),e._uU(253,"Back"),e.qZA(),e.TgZ(254,"button",97),e._uU(255,"Next"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(256,"modal",null,98),e.TgZ(258,"modal-header"),e._uU(259," Payment Modal "),e.qZA(),e.TgZ(260,"modal-content"),e.TgZ(261,"form",76),e.NdJ("ngSubmit",function(){return n.submitPayment(n.paymentGroup.value)}),e.TgZ(262,"div",99),e.TgZ(263,"div",100),e.TgZ(264,"label"),e._uU(265,"Payment"),e.qZA(),e._UZ(266,"input",101),e.GkF(267,102),e.GkF(268,102),e.qZA(),e.TgZ(269,"div",100),e.TgZ(270,"mat-slide-toggle",103),e._uU(271," With Design "),e.qZA(),e.qZA(),e.qZA(),e._UZ(272,"br"),e.TgZ(273,"div",4),e.TgZ(274,"div",100),e.TgZ(275,"button",104),e.NdJ("click",function(){return n.closeModal()}),e._uU(276," X Cancel "),e.qZA(),e.qZA(),e.TgZ(277,"div",100),e.TgZ(278,"button",105),e.YNc(279,Be,2,1,"ng-container",87),e.YNc(280,Ee,2,0,"ng-template",null,106,e.W1O),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(282,"modal",null,107),e.TgZ(284,"modal-header"),e._uU(285," Change Order Request Model "),e.qZA(),e.TgZ(286,"modal-content"),e.TgZ(287,"form",76),e.NdJ("ngSubmit",function(){return n.ChangeRequest()}),e.TgZ(288,"div",108),e.TgZ(289,"div",109),e.TgZ(290,"div",110),e.TgZ(291,"select",111),e.YNc(292,Ye,2,2,"option",112),e.TgZ(293,"option",113),e._uU(294,"Select Request"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(295,"div",114),e.TgZ(296,"div",115),e.TgZ(297,"input",116),e.NdJ("change",function(d){return n.NewRequestName(d.target.checked)}),e.qZA(),e.TgZ(298,"label",117),e._uU(299,"New Request"),e.qZA(),e.YNc(300,Je,1,0,"mat-spinner",59),e.qZA(),e._UZ(301,"input",118),e.qZA(),e.TgZ(302,"div",119),e.TgZ(303,"mat-form-field",78),e.TgZ(304,"mat-label"),e._uU(305,"Search"),e.qZA(),e.TgZ(306,"input",79),e.NdJ("input",function(d){return n.searchOrder=d.target.value}),e.qZA(),e.TgZ(307,"mat-icon",51),e._uU(308,"search"),e.qZA(),e.TgZ(309,"mat-hint"),e._uU(310,"name number category product "),e.qZA(),e.qZA(),e.qZA(),e.TgZ(311,"div",120),e.TgZ(312,"button",121),e.NdJ("click",function(){return e.CHM(a),e.MAs(318).selectAll()}),e._uU(313," Select All "),e.qZA(),e.qZA(),e.TgZ(314,"div",120),e.TgZ(315,"button",122),e.NdJ("click",function(){return e.CHM(a),e.MAs(318).deselectAll()}),e._uU(316," Deselect All "),e.qZA(),e.qZA(),e.qZA(),e.TgZ(317,"mat-selection-list",82,123),e.YNc(319,Qe,2,2,"mat-list-option",84),e.ALo(320,"orderSearch"),e.qZA(),e.TgZ(321,"div",4),e.TgZ(322,"div",100),e.TgZ(323,"button",104),e.NdJ("click",function(){return n.closeModal()}),e._uU(324," X Cancel "),e.qZA(),e.qZA(),e.TgZ(325,"div",100),e.TgZ(326,"button",124),e.YNc(327,He,2,1,"ng-container",87),e.YNc(328,Ve,2,0,"ng-template",null,106,e.W1O),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.YNc(330,ze,1,1,"ng-template",null,125,e.W1O)}if(2&t){const a=e.MAs(226),s=e.MAs(281),d=e.MAs(331);e.xp6(13),e.Q6J("value",null==n.request?null:n.request.name),e.xp6(4),e.Q6J("value",null==n.request?null:n.request.state),e.xp6(4),e.Q6J("value",null==n.request?null:n.request.customer.name),e.xp6(9),e.Oqu(null==n.request?null:n.request.countOrder),e.xp6(5),e.Oqu(null==n.request?null:n.request.totalOrderAmount.toFixed(2)),e.xp6(9),e.Oqu(null==n.request?null:n.request.countPayments),e.xp6(5),e.Oqu(null==n.request?null:n.request.totalPaymentsAmount.toFixed(2)),e.xp6(9),e.Oqu(null==n.request?null:n.request.countInvoices),e.xp6(5),e.Oqu(null==n.request?null:n.request.totalInvoicesAmount.toFixed(2)),e.xp6(8),e.Q6J("ngForOf",null==n.request?null:n.request.orders),e.xp6(6),e.Q6J("ngForOf",null==n.request?null:n.request.payments),e.xp6(6),e.Q6J("ngForOf",null==n.request?null:n.request.invoices),e.xp6(12),e.Oqu(null==n.InfoInvoiceDetail?null:n.InfoInvoiceDetail.number),e.xp6(5),e.Oqu(null==n.InfoInvoiceDetail?null:n.InfoInvoiceDetail.discount),e.xp6(6),e.Oqu(null==n.InfoInvoiceDetail||null==n.InfoInvoiceDetail.payments[0]?null:n.InfoInvoiceDetail.payments[0].amount),e.xp6(5),e.Oqu(null==n.InfoInvoiceDetail?null:n.InfoInvoiceDetail.cash_amount),e.xp6(6),e.Oqu(null==n.InfoInvoiceDetail?null:n.InfoInvoiceDetail.customer_balance),e.xp6(6),e.Oqu(null==n.InfoInvoiceDetail?null:n.InfoInvoiceDetail.note),e.xp6(3),e.Q6J("multiple",!1),e.xp6(1),e.Q6J("ngForOf",null==n.InfoInvoiceDetail?null:n.InfoInvoiceDetail.orders),e.xp6(2),e.Q6J("ngIf","not_paid"==(null==n.InfoInvoiceDetail?null:n.InfoInvoiceDetail.state)),e.xp6(1),e.Q6J("ngIf","not_paid"==(null==n.InfoInvoiceDetail?null:n.InfoInvoiceDetail.state)),e.xp6(7),e.hij(" Total Paid Invoice :",null==n.InfoInvoiceDetail?null:n.InfoInvoiceDetail.total_amount.toFixed(2)," "),e.xp6(2),e.hij("After Discount : ",n.InvoicePaidPrice.toFixed(2),""),e.xp6(2),e.Q6J("formGroup",n.invoicePaidGroup),e.xp6(12),e.Q6J("ngIf",n.invoicePaidGroup.controls.customer_balance.value),e.xp6(12),e.Q6J("ngIf",!n.invoicePaidGroup.controls.customer_balance.value),e.xp6(3),e.Oqu(n.messageError2),e.xp6(20),e.Q6J("ngIf",n.loading),e.xp6(5),e.Q6J("ngIf",null!=n.requestInvoice),e.xp6(6),e.Q6J("formGroup",n.orderInvoiceGroup),e.xp6(19),e.Q6J("ngForOf",e.xi3(219,52,n.filterByOrdersState,n.searchOrder)),e.xp6(3),e.hij(" ",n.messageError," "),e.xp6(3),e.Q6J("ngIf",n.loading)("ngIfElse",a),e.xp6(4),e.Q6J("formGroup",n.invoiceGroup),e.xp6(15),e.Q6J("ngIf",n.invoiceGroup.controls.is_paid.value),e.xp6(18),e.Q6J("formGroup",n.paymentGroup),e.xp6(5),e.Q6J("ngClass",e.WLB(58,We,n.paymentGroup.controls.amount.invalid,n.paymentGroup.controls.amount.valid)),e.xp6(1),e.Q6J("ngTemplateOutlet",d)("ngTemplateOutletContext",e.VKq(61,$e,n.paymentGroup.controls.amount)),e.xp6(1),e.Q6J("ngTemplateOutlet",d)("ngTemplateOutletContext",e.VKq(63,Ke,n.paymentGroup.controls.amount)),e.xp6(11),e.Q6J("ngIf",n.loading)("ngIfElse",s),e.xp6(8),e.Q6J("formGroup",n.changeRequestGroup),e.xp6(5),e.Q6J("ngForOf",n.requests),e.xp6(8),e.Q6J("ngIf",n.loadingRequestNew),e.xp6(19),e.Q6J("ngForOf",e.xi3(320,55,null==n.request?null:n.request.orders,n.searchOrder)),e.xp6(7),e.Q6J("disabled",0==(null==n.request?null:n.request.orders.length)),e.xp6(1),e.Q6J("ngIf",n.loading)("ngIfElse",s)}},directives:[U.pp,U.ib,U.yz,U.yK,J.SP,J.uX,ue.gM,_.sg,D.zS,D.Rb,D.Ef,Q.Ub,D.YI,_.O5,l._Y,l.JL,l.sg,O.KE,O.hX,de.Nt,l.qQ,l.wV,l.Fj,l.JJ,l.u,j.Hw,O.R9,me.n,pe.oG,M.Vq,M.C0,M.VY,O.bx,he.lW,l.Q7,ge.Rr,M.fd,M.Ic,_.mk,_.tP,l.EJ,l.YN,l.Kr,l.Wl,Q.vS,H.$g],pipes:[_e],styles:[".card[_ngcontent-%COMP%]{box-shadow:-1px 2px 6px;border-radius:25px}.border-statistics[_ngcontent-%COMP%]{border:2px dashed grey;border-radius:15px}[_nghost-%COMP%]     mat-tab-header.mat-tab-header{border-radius:20px!important}[_nghost-%COMP%]     .mat-tab-body-content{overflow:hidden!important}.btn-action[_ngcontent-%COMP%]{position:fixed;bottom:0;right:0;padding:50px;z-index:1000}.btn-action[_ngcontent-%COMP%]   .btn-inside[_ngcontent-%COMP%]{height:75px;width:75px;border-radius:50%!important}.loading-items[_ngcontent-%COMP%]{position:absolute;top:50%;left:35%}mat-selection-list[_ngcontent-%COMP%]{height:10rem;overflow:auto}[_nghost-%COMP%]     .mat-horizontal-content-container.ng-star-inserted.ng-tns-c224-2{padding-bottom:0}[_nghost-%COMP%]     input::-webkit-inner-spin-button{display:none}[_nghost-%COMP%]     .mat-drawer-container{color:inherit;background-color:inherit}[_nghost-%COMP%]     .row-odd{background:#8080804f}[_nghost-%COMP%]     mat-spinner{width:25px!important;height:25px!important;position:absolute!important;top:7px!important;right:43px!important}[_nghost-%COMP%]     mat-spinner svg{width:25px!important;height:25px!important}"]}),i})();var G=r(3935);let et=(()=>{class i{transform(t,n){return 0!==t.length&&""!==n&&void 0!==n?t.filter(a=>a.name.toLowerCase().includes(n.toLowerCase())):t}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275pipe=e.Yjl({name:"requestSearch",type:i,pure:!0}),i})();function tt(i,o){1&i&&(e.TgZ(0,"div",12),e._UZ(1,"mat-spinner"),e.qZA())}function nt(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"div",13),e.TgZ(1,"div",14),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw().nav(s.id)}),e.TgZ(2,"h1",15),e._uU(3),e.qZA(),e.TgZ(4,"div",16),e.TgZ(5,"div",17),e._uU(6),e.qZA(),e.TgZ(7,"div",17),e._uU(8),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=o.$implicit;e.xp6(3),e.Oqu(t.name),e.xp6(3),e.hij(" Customer : ",t.customer.name," "),e.xp6(2),e.hij(" Orders Count: ",t.orders_count," ")}}const it=[{path:"all",component:(()=>{class i{constructor(t,n){this._request=t,this._router=n,this.loading=!1,this.requests=[]}ngOnInit(){this.fetchData()}fetchData(){this.fetchRequests()}fetchRequests(t="open"){this.loading=!0,this._request.filterStateRequest(t).pipe((0,v.x)(()=>this.loading=!1)).subscribe(n=>this.requests=n.data.data.slice())}nav(t){this._router.navigate(["request/find",t])}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(k),e.Y36(f.F0))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-request-main"]],decls:30,vars:7,consts:[[1,"nav-title-header","fs-4","fw-bold","text-center"],[1,"container"],[1,"row"],[1,"col-md-8","mb-3"],[1,"order-search"],["type","text","placeholder","search on all requests..",1,"form-control",3,"ngModel","ngModelChange"],[3,"matMenuTriggerFor"],[1,"ms-1"],["class","spinner",4,"ngIf"],["class","col-md-6 mt-3 position-relative",4,"ngFor","ngForOf"],["menufilter","matMenu"],["mat-menu-item","",3,"click"],[1,"spinner"],[1,"col-md-6","mt-3","position-relative"],[1,"card","p-3","cursor-pointer","postion-relative",3,"click"],[1,"fw-bold"],[1,"d-flex","text-primary","justify-content-between"],[1,"p-1"]],template:function(t,n){if(1&t&&(e.TgZ(0,"div",0),e._uU(1,"Request"),e.qZA(),e.TgZ(2,"div",1),e.TgZ(3,"section"),e.TgZ(4,"div",2),e.TgZ(5,"div",3),e.TgZ(6,"div",4),e.TgZ(7,"input",5),e.NdJ("ngModelChange",function(s){return n.searchInput=s}),e.qZA(),e.TgZ(8,"button",6),e.TgZ(9,"span"),e._uU(10,"filter"),e.qZA(),e.TgZ(11,"mat-icon",7),e._uU(12,"settings_input_component"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(13,"div",2),e.TgZ(14,"div",2),e.YNc(15,tt,2,0,"div",8),e.qZA(),e.YNc(16,nt,9,3,"div",9),e.ALo(17,"requestSearch"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(18,"mat-menu",null,10),e.TgZ(20,"button",11),e.NdJ("click",function(){return n.fetchRequests("inprogress")}),e.TgZ(21,"mat-icon"),e._uU(22,"cached"),e.qZA(),e.TgZ(23,"span"),e._uU(24,"InProgress"),e.qZA(),e.qZA(),e.TgZ(25,"button",11),e.NdJ("click",function(){return n.fetchRequests()}),e.TgZ(26,"mat-icon"),e._uU(27,"input"),e.qZA(),e.TgZ(28,"span"),e._uU(29,"Open"),e.qZA(),e.qZA(),e.qZA()),2&t){const a=e.MAs(19);e.xp6(7),e.Q6J("ngModel",n.searchInput),e.xp6(1),e.Q6J("matMenuTriggerFor",a),e.xp6(7),e.Q6J("ngIf",n.loading),e.xp6(1),e.Q6J("ngForOf",e.xi3(17,4,n.requests,n.searchInput))}},directives:[l.Fj,l.JJ,l.On,G.p6,j.Hw,_.O5,_.sg,G.VK,G.OP,H.$g],pipes:[et],styles:[".card[_ngcontent-%COMP%]{box-shadow:-1px 2px 6px;border-radius:25px}.vl[_ngcontent-%COMP%]{border-left:2px solid;height:35px}.mat-sort-header-container[_ngcontent-%COMP%]{justify-content:center!important}a[_ngcontent-%COMP%]{text-decoration:none!important}.btn-plus[_ngcontent-%COMP%]{position:fixed;bottom:0;right:0;padding:50px;z-index:1000}.btn-plus[_ngcontent-%COMP%]   .btn-add-order[_ngcontent-%COMP%]{height:75px;width:75px;border-radius:50%!important}.order-state[_ngcontent-%COMP%]{position:relative;overflow:hidden}.order-state[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:nth-child(1){width:100%;text-align:left}.order-state[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:nth-child(2){position:absolute;top:0;right:10px;border:none;background:none;padding:7px;border-left:1px solid white;color:#fff}.order-search[_ngcontent-%COMP%]{position:relative;height:70%}.order-search[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{position:absolute;top:0;right:0;border:none;background:none;padding:6px;display:flex;align-items:center}mat-selection-list[_ngcontent-%COMP%]{height:16rem;overflow:auto}.loading-items[_ngcontent-%COMP%]{position:absolute;top:50%;left:35%}.group-stage[_ngcontent-%COMP%]{position:absolute;top:0;right:25px}"]}),i})()},{path:"find/:requestId",component:Xe}];let ot=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[f.Bz.forChild(it)],f.Bz]}),i})();var at=r(71),rt=r(6018),L=r(521),q=r(6994),z=r(2458);r(9490),r(6461),r(9765),r(2759),r(6682),r(5435),r(8002),r(7393),r(6782),r(7519),r(5257),r(9761),r(4395),r(7238),r(6237),r(9238),r(946);let Dt=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[_.ez,z.BQ,L.ud,q.ZD],q.ZD,z.BQ]}),i})(),yt=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[_.ez,l.UX,ot,rt.SharedModule,l.u5,D.zk,at.E,Dt]]}),i})()},6058:(R,Z,r)=>{r.d(Z,{i:()=>_});var _=(()=>{return(f=_||(_={})).Order="order",f.RequestOrder="request_order",f.Group="group",f.customer="customer",_;var f})()},6926:(R,Z,r)=>{r.d(Z,{s:()=>f});var _=r(7716);let f=(()=>{class l{constructor(){this.ReadDateClearly=c=>(c.created_at=this.formatDate(c.created_at,!1),c),this.ReadDateTimeClearly=c=>(c.created_at=this.formatDate(c.created_at,!0),c)}convertTimeAmPm(c){var u=c.getHours(),m=c.getMinutes(),e=u>=12?"pm":"am";return(u=(u%=12)||12)+":"+(m=m<10?"0"+m:m)+" "+e}convert12to24Hour(c){const[u,m]=c.split(" ");let[e,p]=u.split(":");"AM"==m?12==parseInt(e,10)&&(e="0"):parseInt(e,10)<12&&(e=(parseInt(e,10)+12).toString());let h="";return parseInt(e,10)<10&&(h="0"),h+=parseInt(e,10)+":"+p,h}convert24to12(c){var u="AM";let[m,e]=c.split(":");var p=+m;p>=12&&(12!=p&&(p-=12),u="PM");var h="";return p<=9&&(h="0"),h+p.toString()+":"+e+" "+u}diffTime(c,u){var[m,e]=c.split(":"),[p,h]=u.split(":");return 60*Math.abs(+m-+p)+Math.abs(+e-+h)}monthDiff(c,u){var m;return m=12*(u.getFullYear()-c.getFullYear()),m-=c.getMonth(),(m+=u.getMonth())<=0?0:m}getDays(c,u){for(var m=[""],e=0,p=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],h=c;h<=u&&!(++e>7);)m.push(p[h.getDay()]),h.setDate(h.getDate()+1);return m.splice(0,1),m}formatDate(c,u){var m=new Date(c),e=""+(m.getMonth()+1),p=""+m.getDate(),h=m.getFullYear();if(u)var C=this.convertTimeAmPm(m);return e.length<2&&(e="0"+e),p.length<2&&(p="0"+p),u?[h,e,p].join("-")+" "+[C].join(":"):[h,e,p].join("-")}modifyDate(c,u,m){return c.setDate(m?c.getDate()+u:c.getDate()-u),c}compareDates(c,u){return c.getFullYear()<u.getFullYear()||c.getFullYear()==u.getFullYear()&&c.getMonth()<u.getMonth()||c.getFullYear()==u.getFullYear()&&c.getMonth()==u.getMonth()&&c.getDate()<u.getDate()?-1:c.getFullYear()>u.getFullYear()||c.getFullYear()==u.getFullYear()&&c.getMonth()>u.getMonth()||c.getFullYear()==u.getFullYear()&&c.getMonth()==u.getMonth()&&c.getDate()>u.getDate()?1:0}getExtension(c){var u=c.split(".");return u[u.length-1]}isImg(c){switch(this.getExtension(c)){case"jpeg":case"jpg":case"png":return!0}return!1}}return l.\u0275fac=function(c){return new(c||l)},l.\u0275prov=_.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"}),l})()},9724:(R,Z,r)=>{r.d(Z,{J:()=>v});var _=r(8259),f=r.n(_),l=r(7716);let v=(()=>{class c{constructor(){}showWarning(){return f().fire({title:"Are you sure?",text:"You will not be able to recover this imaginary file!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"No, keep it"})}cancelOperation(){f().fire("Cancelled","Your imaginary file is safe :)","error")}success(m="Has been deleted suc cessfuly"){f().fire({icon:"success",title:m})}error(m,e){f().fire({icon:"error",title:"Oops..."+m,text:e})}}return c.\u0275fac=function(m){return new(m||c)},c.\u0275prov=l.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})()},1988:(R,Z,r)=>{r.d(Z,{K:()=>m});var _=r(9765),f=r(3927);class l extends f.s{constructor(p){super(p,"api")}AuthLogin(p){return this.createEntity(p,"/login")}GetNewNameModel(p){return this.readEntity(void 0,"/get/name/"+p)}}var v=r(7716),c=r(1841),u=r(1188);let m=(()=>{class e{constructor(h,C){this._storageService=C,this.localStorageUser=new _.xQ,this.authActions=new l(h)}loginUser(h){return this.authActions.AuthLogin(h)}setLocalStorageUser(h){this._storageService.setLocalObject("user",h),this.localStorageUser.next(h)}getUser(){return this.localStorageUser.asObservable()}logout(){this._storageService.removeToken(),this._storageService.removeLocalObject("user"),this.localStorageUser.next(null)}getNewNamesModel(h){return this.authActions.GetNewNameModel(h)}}return e.\u0275fac=function(h){return new(h||e)(v.LFG(c.eN),v.LFG(u.V))},e.\u0275prov=v.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}]);